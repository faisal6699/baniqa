/*!
 * MIT License
 * 
 * Copyright (c) 2020 Yoav Niran
 * 
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 * 
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 * 
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 * 
 */
!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("react"),require("react-dom")):"function"==typeof define&&define.amd?define(["react","react-dom"],t):"object"==typeof exports?exports.rpldy=t(require("react"),require("react-dom")):e.rpldy=t(e.react,e["react-dom"])}(window,(function(e,t){return function(e){function t(t){for(var r,a,i=t[0],c=t[1],l=t[2],s=0,f=[];s<i.length;s++)a=i[s],Object.prototype.hasOwnProperty.call(u,a)&&u[a]&&f.push(u[a][0]),u[a]=0;for(r in c)Object.prototype.hasOwnProperty.call(c,r)&&(e[r]=c[r]);for(d&&d(t);f.length;)f.shift()();return o.push.apply(o,l||[]),n()}function n(){for(var e,t=0;t<o.length;t++){for(var n=o[t],r=!0,i=1;i<n.length;i++){var c=n[i];0!==u[c]&&(r=!1)}r&&(o.splice(t--,1),e=a(a.s=n[0]))}return e}var r={},u={main:0},o=[];function a(t){if(r[t])return r[t].exports;var n=r[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,a),n.l=!0,n.exports}a.m=e,a.c=r,a.d=function(e,t,n){a.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},a.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.t=function(e,t){if(1&t&&(e=a(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(a.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)a.d(n,r,function(t){return e[t]}.bind(null,r));return n},a.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return a.d(t,"a",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p="";var i=window.webpackJsonprpldy=window.webpackJsonprpldy||[],c=i.push.bind(i);i.push=t,i=i.slice();for(var l=0;l<i.length;l++)t(i[l]);var d=c;return o.push(["MIuT","polyfills"]),n()}({"10TY":function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return u})),n.d(t,"c",(function(){return o}));var r="__rupy-logger-debug__",u={PENDING:"pending",ADDED:"added",PROCESSING:"processing",UPLOADING:"uploading",CANCELLED:"cancelled",FINISHED:"finished",ABORTED:"aborted"},o={PENDING:"pending",ADDED:"added",UPLOADING:"uploading",CANCELLED:"cancelled",FINISHED:"finished",ERROR:"error",ABORTED:"aborted"}},MIuT:function(e,t,n){"use strict";n.r(t),n.d(t,"chunkedSender",(function(){return a})),n.d(t,"lifeEvents",(function(){return i})),n.d(t,"mockSender",(function(){return c})),n.d(t,"retry",(function(){return d})),n.d(t,"safeStorage",(function(){return s})),n.d(t,"sender",(function(){return u})),n.d(t,"shared",(function(){return r})),n.d(t,"simpleState",(function(){return o})),n.d(t,"tusSender",(function(){return f})),n.d(t,"uploader",(function(){return l})),n.d(t,"chunkedUploady",(function(){return v})),n.d(t,"retryHooks",(function(){return h})),n.d(t,"sharedUi",(function(){return p})),n.d(t,"tusUploady",(function(){return b})),n.d(t,"uploadButton",(function(){return m})),n.d(t,"uploadDropZone",(function(){return S})),n.d(t,"uploadPreview",(function(){return E})),n.d(t,"uploadUrlInput",(function(){return y})),n.d(t,"uploady",(function(){return g}));var r={};n.r(r),n.d(r,"BATCH_STATES",(function(){return C.a})),n.d(r,"FILE_STATES",(function(){return C.c})),n.d(r,"invariant",(function(){return I.a})),n.d(r,"throttle",(function(){return L.a})),n.d(r,"logger",(function(){return D})),n.d(r,"triggerCancellable",(function(){return k})),n.d(r,"triggerUpdater",(function(){return j})),n.d(r,"createBatchItem",(function(){return Q})),n.d(r,"request",(function(){return ce})),n.d(r,"parseResponseHeaders",(function(){return ie})),n.d(r,"isFunction",(function(){return le.e})),n.d(r,"isPlainObject",(function(){return le.f})),n.d(r,"isSamePropInArrays",(function(){return le.h})),n.d(r,"devFreeze",(function(){return le.b})),n.d(r,"merge",(function(){return le.i})),n.d(r,"getMerge",(function(){return le.c})),n.d(r,"clone",(function(){return le.a})),n.d(r,"pick",(function(){return le.j})),n.d(r,"hasWindow",(function(){return le.d})),n.d(r,"isProduction",(function(){return le.g}));var u={};n.r(u),n.d(u,"default",(function(){return je})),n.d(u,"send",(function(){return Ne})),n.d(u,"getXhrSend",(function(){return ke})),n.d(u,"XHR_SENDER_TYPE",(function(){return he})),n.d(u,"MissingUrlError",(function(){return Le}));var o={};n.r(o),n.d(o,"default",(function(){return it})),n.d(o,"createState",(function(){return it})),n.d(o,"unwrap",(function(){return at})),n.d(o,"isProxy",(function(){return et})),n.d(o,"isProxiable",(function(){return tt}));var a={};n.r(a),n.d(a,"default",(function(){return Rt})),n.d(a,"CHUNK_EVENTS",(function(){return ct})),n.d(a,"CHUNKING_SUPPORT",(function(){return xe})),n.d(a,"CHUNKED_SENDER_TYPE",(function(){return lt})),n.d(a,"CHUNKED_DEFAULT_OPTIONS",(function(){return Be})),n.d(a,"getChunkedEnhancer",(function(){return It})),n.d(a,"createChunkedSender",(function(){return Ot})),n.d(a,"getChunkDataFromFile",(function(){return Fe}));var i={};n.r(i),n.d(i,"default",(function(){return pn})),n.d(i,"addLife",(function(){return pn})),n.d(i,"isLE",(function(){return Jt})),n.d(i,"createLifePack",(function(){return gn}));var c={};n.r(c),n.d(c,"default",(function(){return On})),n.d(c,"MOCK_SENDER_TYPE",(function(){return vn})),n.d(c,"createMockSender",(function(){return En})),n.d(c,"getMockSenderEnhancer",(function(){return yn}));var l={};n.r(l),n.d(l,"default",(function(){return pr})),n.d(l,"UPLOADER_EVENTS",(function(){return In})),n.d(l,"DEFAULT_OPTIONS",(function(){return tr})),n.d(l,"composeEnhancers",(function(){return fr})),n.d(l,"createUploader",(function(){return sr})),n.d(l,"send",(function(){return Ne})),n.d(l,"getXhrSend",(function(){return ke})),n.d(l,"XHR_SENDER_TYPE",(function(){return he})),n.d(l,"MissingUrlError",(function(){return Le}));var d={};n.r(d),n.d(d,"default",(function(){return Sr})),n.d(d,"retryEnhancer",(function(){return Sr})),n.d(d,"RETRY_EVENT",(function(){return vr})),n.d(d,"RETRY_EXT",(function(){return gr}));var s={};n.r(s),n.d(s,"safeLocalStorage",(function(){return Ir})),n.d(s,"safeSessionStorage",(function(){return Rr}));var f={};n.r(f),n.d(f,"CHUNKING_SUPPORT",(function(){return xe})),n.d(f,"TUS_SENDER_TYPE",(function(){return jr})),n.d(f,"getTusEnhancer",(function(){return lu})),n.d(f,"clearResumables",(function(){return Pr})),n.d(f,"TUS_EXT",(function(){return Nr})),n.d(f,"default",(function(){return du}));var p={};n.r(p),n.d(p,"useBatchAddListener",(function(){return Lu})),n.d(p,"useBatchStartListener",(function(){return Cu})),n.d(p,"useBatchProgressListener",(function(){return wu})),n.d(p,"useBatchFinishListener",(function(){return Du})),n.d(p,"useBatchCancelledListener",(function(){return Tu})),n.d(p,"useBatchAbortListener",(function(){return Au})),n.d(p,"useItemStartListener",(function(){return _u})),n.d(p,"useItemFinishListener",(function(){return Pu})),n.d(p,"useItemProgressListener",(function(){return Bu})),n.d(p,"useItemCancelListener",(function(){return Uu})),n.d(p,"useItemErrorListener",(function(){return ku})),n.d(p,"useItemAbortListener",(function(){return Nu})),n.d(p,"useItemFinalizeListener",(function(){return ju})),n.d(p,"useRequestPreSend",(function(){return Hu})),n.d(p,"useAllAbortListener",(function(){return xu})),n.d(p,"generateUploaderEventHook",(function(){return Iu})),n.d(p,"generateUploaderEventHookWithState",(function(){return Ou})),n.d(p,"logWarning",(function(){return Ru})),n.d(p,"assertContext",(function(){return Su})),n.d(p,"useUploadOptions",(function(){return Fu})),n.d(p,"useAbortItem",(function(){return Mu})),n.d(p,"useAbortBatch",(function(){return qu})),n.d(p,"useAbortAll",(function(){return zu})),n.d(p,"NoDomUploady",(function(){return Gu})),n.d(p,"UploadyContext",(function(){return mu})),n.d(p,"createContextApi",(function(){return bu})),n.d(p,"withRequestPreSendUpdate",(function(){return Ku})),n.d(p,"useUploadyContext",(function(){return Eu})),n.d(p,"useUploady",(function(){return Eu}));var g={};n.r(g),n.d(g,"default",(function(){return to})),n.d(g,"useFileInput",(function(){return eo})),n.d(g,"Uploady",(function(){return Yu})),n.d(g,"UPLOADER_EVENTS",(function(){return In})),n.d(g,"DEFAULT_OPTIONS",(function(){return tr})),n.d(g,"composeEnhancers",(function(){return fr})),n.d(g,"createUploader",(function(){return sr})),n.d(g,"send",(function(){return Ne})),n.d(g,"getXhrSend",(function(){return ke})),n.d(g,"XHR_SENDER_TYPE",(function(){return he})),n.d(g,"MissingUrlError",(function(){return Le})),n.d(g,"useBatchAddListener",(function(){return Lu})),n.d(g,"useBatchStartListener",(function(){return Cu})),n.d(g,"useBatchProgressListener",(function(){return wu})),n.d(g,"useBatchFinishListener",(function(){return Du})),n.d(g,"useBatchCancelledListener",(function(){return Tu})),n.d(g,"useBatchAbortListener",(function(){return Au})),n.d(g,"useItemStartListener",(function(){return _u})),n.d(g,"useItemFinishListener",(function(){return Pu})),n.d(g,"useItemProgressListener",(function(){return Bu})),n.d(g,"useItemCancelListener",(function(){return Uu})),n.d(g,"useItemErrorListener",(function(){return ku})),n.d(g,"useItemAbortListener",(function(){return Nu})),n.d(g,"useItemFinalizeListener",(function(){return ju})),n.d(g,"useRequestPreSend",(function(){return Hu})),n.d(g,"useAllAbortListener",(function(){return xu})),n.d(g,"generateUploaderEventHook",(function(){return Iu})),n.d(g,"generateUploaderEventHookWithState",(function(){return Ou})),n.d(g,"logWarning",(function(){return Ru})),n.d(g,"assertContext",(function(){return Su})),n.d(g,"useUploadOptions",(function(){return Fu})),n.d(g,"useAbortItem",(function(){return Mu})),n.d(g,"useAbortBatch",(function(){return qu})),n.d(g,"useAbortAll",(function(){return zu})),n.d(g,"NoDomUploady",(function(){return Gu})),n.d(g,"UploadyContext",(function(){return mu})),n.d(g,"createContextApi",(function(){return bu})),n.d(g,"withRequestPreSendUpdate",(function(){return Ku})),n.d(g,"useUploadyContext",(function(){return Eu})),n.d(g,"useUploady",(function(){return Eu}));var v={};n.r(v),n.d(v,"default",(function(){return oo})),n.d(v,"ChunkedUploady",(function(){return no})),n.d(v,"CHUNK_EVENTS",(function(){return ct})),n.d(v,"useFileInput",(function(){return eo})),n.d(v,"Uploady",(function(){return Yu})),n.d(v,"UPLOADER_EVENTS",(function(){return In})),n.d(v,"DEFAULT_OPTIONS",(function(){return tr})),n.d(v,"composeEnhancers",(function(){return fr})),n.d(v,"createUploader",(function(){return sr})),n.d(v,"send",(function(){return Ne})),n.d(v,"getXhrSend",(function(){return ke})),n.d(v,"XHR_SENDER_TYPE",(function(){return he})),n.d(v,"MissingUrlError",(function(){return Le})),n.d(v,"useBatchAddListener",(function(){return Lu})),n.d(v,"useBatchStartListener",(function(){return Cu})),n.d(v,"useBatchProgressListener",(function(){return wu})),n.d(v,"useBatchFinishListener",(function(){return Du})),n.d(v,"useBatchCancelledListener",(function(){return Tu})),n.d(v,"useBatchAbortListener",(function(){return Au})),n.d(v,"useItemStartListener",(function(){return _u})),n.d(v,"useItemFinishListener",(function(){return Pu})),n.d(v,"useItemProgressListener",(function(){return Bu})),n.d(v,"useItemCancelListener",(function(){return Uu})),n.d(v,"useItemErrorListener",(function(){return ku})),n.d(v,"useItemAbortListener",(function(){return Nu})),n.d(v,"useItemFinalizeListener",(function(){return ju})),n.d(v,"useRequestPreSend",(function(){return Hu})),n.d(v,"useAllAbortListener",(function(){return xu})),n.d(v,"generateUploaderEventHook",(function(){return Iu})),n.d(v,"generateUploaderEventHookWithState",(function(){return Ou})),n.d(v,"logWarning",(function(){return Ru})),n.d(v,"assertContext",(function(){return Su})),n.d(v,"useUploadOptions",(function(){return Fu})),n.d(v,"useAbortItem",(function(){return Mu})),n.d(v,"useAbortBatch",(function(){return qu})),n.d(v,"useAbortAll",(function(){return zu})),n.d(v,"NoDomUploady",(function(){return Gu})),n.d(v,"UploadyContext",(function(){return mu})),n.d(v,"createContextApi",(function(){return bu})),n.d(v,"withRequestPreSendUpdate",(function(){return Ku})),n.d(v,"useUploadyContext",(function(){return Eu})),n.d(v,"useUploady",(function(){return Eu})),n.d(v,"useChunkStartListener",(function(){return ro})),n.d(v,"useChunkFinishListener",(function(){return uo}));var h={};n.r(h),n.d(h,"default",(function(){return so})),n.d(h,"RETRY_EVENT",(function(){return vr})),n.d(h,"retryEnhancer",(function(){return Sr})),n.d(h,"useRetry",(function(){return io})),n.d(h,"useBatchRetry",(function(){return co})),n.d(h,"useRetryListener",(function(){return lo}));var b={};n.r(b),n.d(b,"default",(function(){return go})),n.d(b,"TusUploady",(function(){return fo})),n.d(b,"useClearResumableStore",(function(){return po})),n.d(b,"useFileInput",(function(){return eo})),n.d(b,"Uploady",(function(){return Yu})),n.d(b,"UPLOADER_EVENTS",(function(){return In})),n.d(b,"DEFAULT_OPTIONS",(function(){return tr})),n.d(b,"composeEnhancers",(function(){return fr})),n.d(b,"createUploader",(function(){return sr})),n.d(b,"send",(function(){return Ne})),n.d(b,"getXhrSend",(function(){return ke})),n.d(b,"XHR_SENDER_TYPE",(function(){return he})),n.d(b,"MissingUrlError",(function(){return Le})),n.d(b,"useBatchAddListener",(function(){return Lu})),n.d(b,"useBatchStartListener",(function(){return Cu})),n.d(b,"useBatchProgressListener",(function(){return wu})),n.d(b,"useBatchFinishListener",(function(){return Du})),n.d(b,"useBatchCancelledListener",(function(){return Tu})),n.d(b,"useBatchAbortListener",(function(){return Au})),n.d(b,"useItemStartListener",(function(){return _u})),n.d(b,"useItemFinishListener",(function(){return Pu})),n.d(b,"useItemProgressListener",(function(){return Bu})),n.d(b,"useItemCancelListener",(function(){return Uu})),n.d(b,"useItemErrorListener",(function(){return ku})),n.d(b,"useItemAbortListener",(function(){return Nu})),n.d(b,"useItemFinalizeListener",(function(){return ju})),n.d(b,"useRequestPreSend",(function(){return Hu})),n.d(b,"useAllAbortListener",(function(){return xu})),n.d(b,"generateUploaderEventHook",(function(){return Iu})),n.d(b,"generateUploaderEventHookWithState",(function(){return Ou})),n.d(b,"logWarning",(function(){return Ru})),n.d(b,"assertContext",(function(){return Su})),n.d(b,"useUploadOptions",(function(){return Fu})),n.d(b,"useAbortItem",(function(){return Mu})),n.d(b,"useAbortBatch",(function(){return qu})),n.d(b,"useAbortAll",(function(){return zu})),n.d(b,"NoDomUploady",(function(){return Gu})),n.d(b,"UploadyContext",(function(){return mu})),n.d(b,"createContextApi",(function(){return bu})),n.d(b,"withRequestPreSendUpdate",(function(){return Ku})),n.d(b,"useUploadyContext",(function(){return Eu})),n.d(b,"useUploady",(function(){return Eu}));var m={};n.r(m),n.d(m,"default",(function(){return bo})),n.d(m,"UploadButton",(function(){return ho})),n.d(m,"asUploadButton",(function(){return vo}));var S={};n.r(S),n.d(S,"default",(function(){return Eo})),n.d(S,"UploadDropZone",(function(){return So}));var E={};n.r(E),n.d(E,"PREVIEW_TYPES",(function(){return yo})),n.d(E,"default",(function(){return wo})),n.d(E,"UploadPreview",(function(){return Ao}));var y={};n.r(y),n.d(y,"default",(function(){return Uo})),n.d(y,"UploadUrlInput",(function(){return Po}));var O=n("kvau"),I=n.n(O),R=n("uDTZ"),L=n.n(R),C=n("10TY"),D=n("ytft"),T=n("TEMH"),A=n.n(T),w=n("o+MX"),_=n.n(w),P=n("OBge"),U=n.n(P),k=function(e,t){for(var n,r=function(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),u=1;u<n;u++)r[u-1]=arguments[u];return new U.a((function(n,u){var o,a=e.apply(void 0,_()(o=[t]).call(o,r));a&&a.length?U.a.all(a).catch(u).then((function(e){return e&&n(!!~A()(e).call(e,(function(e){return!1===e})))})):n(!1)}))},u=arguments.length,o=new Array(u>2?u-2:0),a=2;a<u;a++)o[a-2]=arguments[a];return t?r.apply(void 0,_()(n=[t]).call(n,o)):r},N=function(e){return null==e},j=function(e,t){for(var n,r=function(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),u=1;u<n;u++)r[u-1]=arguments[u];return new U.a((function(n,u){var o,a=e.apply(void 0,_()(o=[t]).call(o,r));a&&a.length?U.a.all(a).catch(u).then((function(e){var t;if(e)for(;N(t)&&e.length;)t=e.pop();n(N(t)?void 0:t)})):n()}))},u=arguments.length,o=new Array(u>2?u-2:0),a=2;a<u;a++)o[a-2]=arguments[a];return t?r.apply(void 0,_()(n=[t]).call(n,o)):r},B=n("LYCE"),H=n.n(B),x=n("nhkr"),F=n.n(x),M=n("CtDf"),q=n.n(M),z=q()("__rpldy-bi__"),G=0,K=function(e,t){return e.url=t,e},X=function(e,t){return e.file=t,e},W=function(e){return e&&(e instanceof Blob||e instanceof File||"object"===F()(e)&&e.name&&e.type)},Q=function(e,t){var n,r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];G+=1;var u=e.id&&e.batchId?e.id:_()(n="".concat(t,".item-")).call(n,G),o=r?C.c.PENDING:C.c.ADDED,a={id:u,batchId:t,state:o,completed:0,loaded:0,aborted:!1,recycled:!1,previousBatch:null};if(H()(a,z,{value:!0,writable:!0}),"object"===F()(e)&&!0===e[z]&&(a.recycled=!0,a.previousBatch=e.batchId,e=e.file||e.url),"string"==typeof e)a=K(a,e);else{if(!W(e))throw new Error("Unknown type of file added: ".concat(F()(e)));a=X(a,e)}return a},V=n("+oHS"),Y=n.n(V),Z=n("RXMP"),J=n.n(Z),$=function(e,t){var n;t&&J()(n=Y()(t)).call(n,(function(n){void 0!==t[n]&&e.setRequestHeader(n,t[n])}))},ee=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=new XMLHttpRequest,u=new U.a((function(u,o){r.onerror=function(){return o(r)},r.ontimeout=function(){return o(r)},r.onabort=function(){return o(r)},r.onload=function(){return u(r)},r.open(n.method||"GET",e),$(r,n.headers),r.withCredentials=!!n.withCredentials,n.preSend&&n.preSend(r),r.send(t)}));return u.xhr=r,u},te=n("zLi2"),ne=n.n(te),re=n("RKTd"),ue=n.n(re),oe=n("KYsz"),ae=n.n(oe),ie=function(e){var t;try{var n,r;t=ae()(n=ue()(r=e.getAllResponseHeaders()).call(r).split(/[\r\n]+/)).call(n,(function(e,t){var n=t.split(": "),r=ne()(n,2),u=r[0],o=r[1];return e[u]=o,e}),{})}catch(t){Object(D.debugLog)("uploady.request: failed to read response headers",e)}return t},ce=ee,le=n("VPmE"),de=n("ZbhI"),se=n.n(de),fe=n("UtpJ"),pe=n.n(fe),ge=n("kT1S"),ve=n.n(ge),he="rpldy-sender",be=n("06Pm"),me=n.n(be),Se=n("X5/F"),Ee=n.n(Se),ye=n("K82H"),Oe=n.n(ye),Ie=n("P0a4"),Re=n.n(Ie),Le=function(e){Ee()(n,e);var t=Oe()(n);function n(e){var r;return me()(this,n),(r=t.call(this,"".concat(e," didn't receive upload URL"))).name="MissingUrlError",r}return n}(Re()(Error)),Ce=n("i5y0"),De=n.n(Ce),Te=function(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),u=2;u<n;u++)r[u-2]=arguments[u];var o,a;e.set?e.set.apply(e,_()(o=[t]).call(o,r)):(e.delete&&e.delete(t),e.append.apply(e,_()(a=[t]).call(a,r)))},Ae=function(e,t){var n,r=new FormData;t.params&&J()(n=De()(t.params)).call(n,(function(e){var t=ne()(e,2),n=t[0],u=t[1];return Te(r,n,u)}));return function(e,t,n){var r=1===t.length;J()(t).call(t,(function(t,u){var o,a=r?n.paramName:Object(le.e)(n.formatGroupParamName)?n.formatGroupParamName(u,n.paramName):_()(o="".concat(n.paramName,"[")).call(o,u,"]");t.file?Te(e,a,t.file,t.file.name):t.url&&Te(e,a,t.url)}))}(r,e,t),r},we=[200,201,202,203,204],_e=function(e,t,n,r,u){var o,a=(null==u?void 0:u.getRequestData)?u.getRequestData(e,n):function(e,t){var n;if(t.sendWithFormData)D.debugLog("uploady.sender: sending ".concat(e.length," item(s) as form data")),n=Ae(e,t);else{if(e.length>1)throw new Error("XHR Sender - Request without form data can only contain 1 item. received ".concat(e.length));var r=e[0];D.debugLog("uploady.sender: sending item ".concat(r.id," as request body")),n=r.file||r.url}return n}(e,n),i=function(){var u=arguments.length>0&&void 0!==arguments[0]?arguments[0]:t,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:a,c=arguments.length>2?arguments[2]:void 0;c=Object(le.i)(ve()(ve()({},Object(le.j)(n,["method","headers","withCredentials"])),{},{preSend:function(t){t.upload.onprogress=function(t){t.lengthComputable&&r&&r(t,pe()(e).call(e))}}}),c);var l=ce(u,i,c);return o=l.xhr,l},c=(null==u?void 0:u.preRequestHandler)?u.preRequestHandler(i,e,t,n,r,u):i();return{url:t,count:e.length,pXhr:c,getXhr:function(){return o},aborted:!1}},Pe=function(e,t,n){var r=e,u=t&&t["content-type"];if(n.forceJsonResponse||u&&~se()(u).call(u,"json"))try{r=JSON.parse(e)}catch(e){}return r},Ue=function(e,t){return e.pXhr.then((function(e){var n,r;D.debugLog("uploady.sender: received upload response ",e),n=~se()(we).call(we,e.status)?C.c.FINISHED:C.c.ERROR,r=e.status;var u=ie(e);return{status:r,state:n,response:{data:Pe(e.response,u,t),headers:u}}})).catch((function(t){var n,r;return e.aborted?(n=C.c.ABORTED,r="aborted"):(D.debugLog("uploady.sender: upload failed: ",t),n=C.c.ERROR,r=t),{error:!0,state:n,response:r,status:0}}))},ke=function(e){return function(t,n,r,u){if(!n)throw new Le(he);D.debugLog("uploady.sender: sending file: ",{items:t,url:n,options:r});var o=_e(t,n,r,u,e);return{request:Ue(o,r),abort:function(){return function(e){var t,n=!1,r=e.aborted,u=(0,e.getXhr)();!r&&u&&u.readyState&&4!==u.readyState&&(D.debugLog(_()(t="uploady.sender: cancelling request with ".concat(e.count," items to: ")).call(t,e.url)),u.abort(),e.aborted=!0,n=!0);return n}(o)},senderType:he}}},Ne=ke(),je=Ne,Be=Object(le.b)({chunked:!0,chunkSize:5242880,retries:0,parallel:1}),He=null,xe=(He=null,Object(le.d)()&&"Blob"in window&&(He=pe()(Blob.prototype)||Blob.prototype.webkitSlice||Blob.prototype.mozSlice),!!He),Fe=function(e,t,n){var r,u=null===(r=He)||void 0===r?void 0:r.call(e,t,n,e.type);return u&&(u.name=e.name,u.lastModified=e.lastModified),u},Me=n("sLxP"),qe=n.n(Me),ze=n("FLGM"),Ge=n.n(ze),Ke=function(e){Ee()(n,e);var t=Oe()(n);function n(e){var r;return me()(this,n),(r=t.call(this,e)).name="ChunkedSendError",r}return n}(Re()(Error)),Xe=n("M5Mt"),We=n.n(Xe),Qe=q()("__rpldy-sstt-proxy__"),Ve=q()("__rpldy-sstt-state__"),Ye=n("6UaR"),Ze=n.n(Ye),Je=n("OWCx"),$e=n.n(Je),et=function(e){var t;return!Object(le.g)()&&!!e&&!!~se()(t=$e()(e)).call(t,Qe)},tt=function(e){return Ze()(e)||Object(le.f)(e)&&!function(e){return Object(le.d)()&&e instanceof File||e.name&&e.size&&e.uri}(e)},nt=Object(le.c)({withSymbols:!0,predicate:function(e){return e!==Qe&&e!==Ve}}),rt=function(e){return!!Object(le.g)()||e[Ve].isUpdateable},ut=function(e,t){Object(le.g)()||(e[Ve].isUpdateable=t)},ot=function(e,t){var n,r;tt(e)&&(et(e)||(e[Qe]=!0,n=new Proxy(e,t)),J()(r=Y()(e)).call(r,(function(n){e[n]=ot(e[n],t)})));return n||e},at=function(e){return et(e)?Object(le.a)(e,nt):e},it=function(e){var t={set:function(e,r,u){return rt(n)&&(e[r]=ot(u,t)),!0},get:function(e,t){return t===Qe?at(e):e[t]},defineProperty:function(){throw new Error("Simple State doesnt support defining property")},setPrototypeOf:function(){throw new Error("Simple State doesnt support setting prototype")},deleteProperty:function(e,t){return rt(n)&&delete e[t],!0}};Object(le.g)()||et(e)||H()(e,Ve,{value:{isUpdateable:!1},configurable:!0});var n=Object(le.g)()?e:ot(e,t);return{state:n,update:function(e){if(!Object(le.g)()&&rt(n))throw new Error("Can't call update on State already being updated!");try{ut(n,!0),e(n)}finally{ut(n,!1)}return n},unwrap:function(e){return e?at(e):et(n)?at(n):n}}},ct=Object(le.b)({CHUNK_START:"CHUNK_START",CHUNK_FINISH:"CHUNK_FINISH"}),lt="rpldy-chunked-sender",dt=n("mnMc"),st=n.n(dt),ft=function(e,t,n){var r,u;return t&&_()(r=_()(u="bytes ".concat(e.start,"-")).call(u,e.start+t.size-1,"/")).call(r,n.file.size)},pt=Object(le.c)({undefinedOverwrites:!0}),gt=function(e,t,n,r,u){var o,a=ve()(ve()({},at(t.sendOptions)),{},{headers:ve()(ve()({},t.sendOptions.headers),{},{"Content-Range":ft(e,e.data,n)})}),i=Q(e.data,e.id),c=function(t){r(t,[e])},l=se()(o=t.chunks).call(o,e);return j(u,ct.CHUNK_START,{item:at(n),chunk:Object(le.j)(e,["id","start","end","index","attempt"]),chunkItem:i,sendOptions:a,url:t.url,chunkIndex:l,chunkCount:t.chunks.length,onProgress:r}).then((function(e){var r,u=!1===e;u&&D.debugLog(_()(r="chunkedSender.sendChunk: received false from CHUNK_START handler - skipping chunk ".concat(l,", item ")).call(r,n.id));return u?{request:U.a.resolve({state:C.c.FINISHED,response:"skipping chunk as instructed by CHUNK_START handler",status:200}),abort:function(){return!0},senderType:"chunk-skipped-sender"}:je([i],(null==e?void 0:e.url)||t.url,pt({},a,e&&e.sendOptions),c)}))},vt=function(e,t){e(t instanceof Ke?{state:C.c.ERROR,response:"At least one chunk failed"}:{state:C.c.ERROR,response:t.message})},ht=function(e,t,n,r){e.finished=!0,n({state:r,response:{results:e.responses}})},bt=function(e,t,n,r,u,o){return new U.a((function(a,i){try{var c=function(e,t,n,r,u){var o,a,i;if(e.data||(e.data=Fe(n.file,e.start,e.end)),!e.data)throw new Ke("chunk failure - failed to slice");D.debugLog(_()(o=_()(a=_()(i="chunkedSender.sendChunk: about to send chunk ".concat(e.id," [")).call(i,e.start,"-")).call(a,e.end,"] to: ")).call(o,t.url||""));var c=gt(e,t,n,r,u);return{request:c.then((function(e){return e.request})),abort:function(){return c.then((function(e){return(0,e.abort)()})),!0},senderType:"chunk-passthrough-sender"}}(u,e,t,n,o);(function(e,t,n,r,u){return e.requests[n]={id:n,abort:r.abort},r.request.then((function(r){var o;D.debugLog("chunkedSender: request finished for chunk: ".concat(n," - "),r),delete e.requests[n];var a=A()(o=e.chunks).call(o,(function(e){return e.id===n}));if(~a){if(r.state===C.c.FINISHED){var i,c=We()(i=e.chunks).call(i,a,1);u(ct.CHUNK_FINISH,{chunk:Object(le.j)(c[0],["id","start","end","index","attempt"]),item:at(t),uploadData:r})}else r.state!==C.c.ABORTED&&(e.chunks[a].attempt+=1);e.responses.push(r.response)}}))})(e,t,u.id,c,o).then((function(){a(),function(e,t,n){var r=!e.chunks.length;return e.aborted?(D.debugLog("chunkedSender: chunked upload aborted for item: ".concat(t.id)),ht(e,0,n,C.c.ABORTED)):r&&!e.error&&(D.debugLog("chunkedSender: chunked upload finished for item: ".concat(t.id),e.responses),ht(e,0,n,C.c.FINISHED)),r||e.error}(e,t,r)||mt(e,t,n,r,o)}))}catch(e){i(e)}}))},mt=function(e,t,n,r,u){if(!e.finished&&!e.aborted){var o=Y()(e.requests).length;if(!o||e.parallel&&e.parallel>o){var a;try{a=function(e){for(var t=[],n=Y()(e.requests),r=e.parallel||1,u=0;u<e.chunks.length&&n.length<r&&t.length<r;u++){var o=e.chunks[u];if(!st()(n).call(n,o.id)){if(o.attempt&&!(o.attempt<e.retries))throw new Ke("chunk failure");t.push(o)}}return t}(e)}catch(e){vt(r,e)}a&&J()(a).call(a,(function(o){bt(e,t,n,r,o,u).catch((function(t){e.error=!0,vt(r,t)}))}))}}},St=mt,Et=function(e,t,n,r){var u=L()((function(r,u){var o,a=u[0].id;e.uploaded[a]=r.loaded;var i=ae()(o=Y()(e.uploaded)).call(o,(function(t,n){return t+e.uploaded[n]}),0);n({loaded:i,total:t.file.size},[t])}),100,!0);return{sendPromise:new U.a((function(n){St(e,t,u,n,r)})),abort:function(){return function(e,t){var n;(D.debugLog("chunkedSender: aborting chunked upload for item: ".concat(t.id)),e.finished||e.aborted)||(J()(n=Y()(e.requests)).call(n,(function(t){D.debugLog("chunkedSender: aborting chunk: ".concat(t)),e.requests[t].abort()})),e.aborted=!0);return e.aborted}(e,t)}}},yt=function(e,t,n,r,u,o){var a,i=function(e,t){var n,r,u,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,a=t.chunkSize,i=o?e.file.size-o:e.file.size;if(i<=0)throw new Ke(_()(u="start byte ".concat(o," is invalid. File size: ")).call(u,e.file.size));var c=i<=a?1:Math.ceil(i/a);return Ge()(n=qe()(r=new Array(c)).call(r,null)).call(n,(function(t,n){var r,u=a*n+(o||0);return{id:_()(r="".concat(e.id,"_chunk-")).call(r,n),start:u,end:Math.min(u+a,e.file.size),data:null,attempt:0,uploaded:0,index:n}}))}(e,t,r.startByte);D.debugLog(_()(a="chunkedSender: created ".concat(i.length," chunks for: ")).call(a,e.file.name));var c=ve()({finished:!1,aborted:!1,error:!1,uploaded:{},requests:{},responses:[],chunks:i,url:n,sendOptions:r},t),l=Et(c,e,u,o);return{request:l.sendPromise,abort:l.abort,senderType:lt}},Ot=function(e,t){var n=function(e){return Object(le.i)({},Be,e)}(e);return{send:function(e,r,u,o){var a;return!n.chunked||e.length>1||e[0].url||!e[0].file.size?(a=je(e,r,u,o),D.debugLog("chunkedSender: sending items as normal, un-chunked requests")):(D.debugLog("chunkedSender: sending file as a chunked request"),a=yt(e[0],n,r,u,o,t)),a}}},It=function(e){return function(t,n){var r=Ot(e,n);return t.update({send:r.send}),t}},Rt=It,Lt=n("04Ix"),Ct=n.n(Lt),Dt=n("RSWj"),Tt=n.n(Dt),At=n("HnXd"),wt=n.n(At),_t=n("Vi3r"),Pt=n.n(_t),Ut=n("5PDf"),kt=n.n(Ut),Nt=n("eLKs"),jt=n.n(Nt),Bt=n("STz3"),Ht=n.n(Bt),xt=n("cdeZ"),Ft=n.n(xt),Mt=n("/FZm"),qt=n.n(Mt),zt=n("JlUD"),Gt=n.n(zt),Kt=Object(le.b)({allowRegisterNonExistent:!0,canAddEvents:!0,canRemoveEvents:!0,collectStats:!1}),Xt=function(e,t){if(!Object(le.e)(e))throw new Error("'".concat(t,"' is not a valid function"))},Wt=function(e){return void 0===e},Qt=q()("__le__"),Vt=q()("__le__pack__"),Yt=function(e){return e?e[Qt]:null},Zt=function(e){var t=Yt(e);if(!t)throw new Error("Didnt find LE internal object. Something very bad happened!");return t},Jt=function(e){return!!Yt(e)},$t=function(e,t,n){var r,u=arguments.length>3&&void 0!==arguments[3]&&arguments[3];Xt(n,"cb");var o=Zt(e);if(!o.options.allowRegisterNonExistent&&!~se()(r=o.events).call(r,t))throw new Error("Cannot register for event ".concat(t.toString()," that wasn't already defined (allowRegisterNonExistent = false)"));var a=o.registry[t]||[];return qt()(a).call(a,(function(e){return e.cb===n}))||(a.push({name:t,cb:n,once:u}),o.registry[t]=a),function(){return cn.call(e,t,n)}},en=function(e,t){var n,r,u=Zt(e).registry;return t?u[t]?pe()(n=u[t]).call(n):[]:Ft()(r=Ht()(u)).call(r)},tn={on:function(e,t){return $t(this,e,t)},once:function(e,t){return $t(this,e,t,!0)},off:cn,getEvents:function(){var e;return pe()(e=Zt(this).events).call(e)}},nn=function(){var e;return ae()(e=De()(tn)).call(e,(function(e,t){var n=ne()(t,2),r=n[0],u=n[1];return e[r]={value:u},e}),{})},rn={trigger:function(e){for(var t=this,n=arguments.length,r=new Array(n>1?n-1:0),u=1;u<n;u++)r[u-1]=arguments[u];var o,a=en(this,e);if(a.length){var i,c,l,d;1===r.length&&!0===(null===(i=r[0])||void 0===i?void 0:i[Vt])&&(d=r[0].resolve()),o=Ge()(c=kt()(l=Ge()(a).call(a,(function(n){return n.once&&an(t,e,n.cb),d?n.cb.apply(n,Pt()(d)):r.length?1===r.length?n.cb(r[0]):2===r.length?n.cb(r[0],r[1]):3===r.length?n.cb(r[0],r[1],r[2]):n.cb.apply(n,r):n.cb()}))).call(l,(function(e){return!Wt(e)}))).call(c,(function(e){return Gt()(e)?e:U.a.resolve(e)}))}return o&&(o.length?o:void 0)},addEvent:function(e){var t=Zt(this);if(!t.options.canAddEvents)throw new Error("Cannot add new events (canAddEvents = false)");var n;if(~se()(n=t.events).call(n,e))throw new Error("Event '".concat(e,"' already defined"));t.events.push(e)},removeEvent:function(e){var t=Zt(this);if(!t.options.canRemoveEvents)throw new Error("Cannot remove events (canRemoveEvents = false)");var n,r,u=se()(n=t.events).call(n,e);We()(r=t.events).call(r,u,1)},hasEvent:function(e){var t,n=Zt(this);return!!~se()(t=n.events).call(t,e)},hasEventRegistrations:function(e){return!!en(this,e).length},assign:function(e){var t=Zt(this);return fn(e,t.options,t.events,t.registry,t.stats),un(e)}},un=function(e){var t;return ae()(t=Y()(rn)).call(t,(function(t,n){var r;return t[n]=jt()(r=rn[n]).call(r,e),t}),ve()({target:e},rn))},on=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=Zt(e).registry;!r[t]||!n&&r[t].length||delete r[t]},an=function(e,t,n){var r,u=Zt(e).registry;u[t]&&(n?(u[t]=kt()(r=u[t]).call(r,(function(e){return e.cb!==n})),on(e,t)):on(e,t,!0))};function cn(e,t){an(this,e,t)}var ln,dn,sn,fn=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},u=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};wt()(e,ve()(Ct()({},Qt,{value:Tt()({registry:r,events:n,options:t,stats:u})}),nn()))},pn=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2?arguments[2]:void 0;return e=e||{},n=ve()(ve()({},Kt),n),Jt(e)||fn(e,n,t),un(e)},gn=function(e){var t={resolve:function(){var t;return _()(t=[]).call(t,e())}};return H()(t,Vt,{value:!0,configurable:!1}),t},vn="rpldy-mock-sender",hn=n("Kwsy"),bn=n.n(hn),mn=Object(le.b)({delay:500,fileSize:1e6,progressIntervals:[10,25,50,75,99]}),Sn=function(e,t,n){return e.then((function(e){return D.debugLog("uploady.mockSender: mock request finished successfully"),{status:t.responseStatus||200,state:C.c.FINISHED,response:ve()(ve()({},e),{},{headers:{"x-request-type":"react-uploady.mockSender"},data:t.response||{sendOptions:n,mock:!0,success:!0}})}})).catch((function(){return D.debugLog("uploady.mockSender: mock request was aborted"),{status:0,state:C.c.ABORTED,response:"abort"}}))},En=function(e){var t=ve()(ve()({},mn),e);return{send:function(e,n,r,u){D.debugLog("uploady.mockSender: about to make a mock request for items: ",e);var o=function(e,t){var n,r,u=performance.now(),o=[],a=!1,i=!1,c=null,l=null,d=null,s=function(){l&&(J()(l).call(l,(function(e){clearTimeout(e)})),l=null)},f=new U.a((function(t,n){d=n,bn()((function(){i=!0,t({options:e,time:performance.now()-u,progressEvents:o}),s()}),e.delay||0)}));e.progressIntervals&&(l=Ge()(r=e.progressIntervals).call(r,(function(n){var r=n/100,u=(e.delay||0)*r;return bn()((function(){if(!a&&!i&&c){var n={total:e.fileSize||0,loaded:(e.fileSize||0)*r};o.push(n),c(n,t)}}),u)})));return{then:jt()(n=f.then).call(n,f),abort:function(){return a=!0,i=!0,d&&d(),s(),!0},onProgress:function(e){c=e}}}(t,e);return o.onProgress(u),{request:Sn(o,t,r),abort:o.abort,senderType:vn}},update:function(e){t=ve()(ve()({},t),e)}}},yn=function(e){return function(t){var n=En(e);return t.update({send:n.send}),t}},On=En,In=Object(le.b)({BATCH_ADD:"BATCH-ADD",BATCH_START:"BATCH-START",BATCH_PROGRESS:"BATCH_PROGRESS",BATCH_FINISH:"BATCH-FINISH",BATCH_ABORT:"BATCH-ABORT",BATCH_CANCEL:"BATCH-CANCEL",ITEM_START:"FILE-START",ITEM_CANCEL:"FILE-CANCEL",ITEM_PROGRESS:"FILE-PROGRESS",ITEM_FINISH:"FILE-FINISH",ITEM_ABORT:"FILE-ABORT",ITEM_ERROR:"FILE-ERROR",ITEM_FINALIZE:"FILE-FINALIZE",REQUEST_PRE_SEND:"REQUEST_PRE_SEND",ALL_ABORT:"ALL_ABORT"}),Rn=Object(le.b)({ITEM_PROGRESS:"ITEM_PROGRESS",BATCH_PROGRESS:"BATCH_PROGRESS"}),Ln=[C.c.FINISHED,C.c.ERROR,C.c.CANCELLED,C.c.ABORTED],Cn=[C.a.ADDED,C.a.PROCESSING,C.a.UPLOADING],Dn=function(e,t){return e.batches[t].batch},Tn=function(e,t,n){return e.getState().items[t].batchId===n},An=function(e,t){var n=e.getState(),r=n.items[t];return n.batches[r.batchId]},wn=function(e,t){return An(e,t).batch},_n=function(e,t){var n=function(e,t){return Dn(e.getState(),t)}(e,t);e.updateState((function(e){var t;J()(t=n.items).call(t,(function(t){var n,r=t.id;delete e.items[r];var u,o=se()(n=e.itemQueue).call(n,r);~o&&We()(u=e.itemQueue).call(u,o,1)}))}))},Pn=function(e,t){e.updateState((function(e){delete e.batches[t]}))},Un=function(e,t){var n=wn(e,t);return e.getState().currentBatch!==n.id},kn=function(e){var t=e.getState(),n=t.currentBatch;n&&t.batches[n]&&function(e){var t=e.getState().itemQueue;return 0===t.length||Un(e,t[0])}(e)&&(Nn(e,n,In.BATCH_FINISH),_n(e,n),Pn(e,n))},Nn=function(e,t,n){var r,u=e.getState(),o=Dn(u,t),a=u.items,i=ve()(ve()({},at(o)),{},{items:Ge()(r=o.items).call(r,(function(e){var t=e.id;return at(a[t])}))});e.trigger(n,i)},jn=function(e,t){var n=wn(e,t);return st()(Cn).call(Cn,n.state)},Bn=function(e,t){var n,r=e.getState(),u=Dn(r,t);qt()(n=u.items).call(n,(function(e){return!st()(Ln).call(Ln,e.state)}))||(_n(e,t),Pn(e,t))},Hn=(ln={},Ct()(ln,C.c.PENDING,null),Ct()(ln,C.c.ADDED,In.ITEM_START),Ct()(ln,C.c.FINISHED,In.ITEM_FINISH),Ct()(ln,C.c.ERROR,In.ITEM_ERROR),Ct()(ln,C.c.CANCELLED,In.ITEM_CANCEL),Ct()(ln,C.c.ABORTED,In.ITEM_ABORT),Ct()(ln,C.c.UPLOADING,In.ITEM_PROGRESS),ln),xn=function(e){return!!~se()(Ln).call(Ln,e.state)},Fn=function(e,t,n){return J()(t).call(t,(function(t){var n,r=e.getState(),u=t.id,o=t.info;if(D.debugLog("uploader.processor.queue: request finished for item - ",{id:u,info:o}),r.items[u]){e.updateState((function(e){var t=e.items[u];t.state=o.state,t.uploadResponse=o.response,xn(t)&&delete e.aborts[u]}));var a=e.getState().items[u];o.state===C.c.FINISHED&&a.completed<100&&e.handleItemProgress(a,100,a.file?a.file.size:0),Hn[a.state]&&e.trigger(Hn[a.state],a),xn(a)&&e.trigger(In.ITEM_FINALIZE,a)}var i=se()(n=r.itemQueue).call(n,u);~i&&e.updateState((function(e){var t,n;We()(t=e.itemQueue).call(t,i,1);var r,o=se()(n=e.activeIds).call(n,u);~o&&We()(r=e.activeIds).call(r,o,1)}))})),kn(e),n(e)},Mn=Object(le.c)({undefinedOverwrites:!0}),qn=function(e,t){var n=Ge()(t).call(t,(function(e){return e.id}));return e.updateState((function(e){var t;e.activeIds=_()(t=e.activeIds).call(t,n)})),function(e,t,n){return j(e.trigger,In.REQUEST_PRE_SEND,{items:t,options:n}).then((function(e){if(e){if(D.debugLog("uploader.queue: REQUEST_PRE_SEND event returned updated items/options",e),e.items){if(e.items.length!==t.length||!Object(le.h)(e.items,t,["id","batchId","recycled"]))throw new Error("REQUEST_PRE_SEND event handlers must return same items with same ids");t=e.items}e.options&&(n=Mn({},n,e.options))}return{items:t,options:n,cancelled:!1===e}}))}(e,t,e.getState().batches[t[0].batchId].batchOptions).then((function(n){if(!n.cancelled){var r;e.updateState((function(e){var r;J()(r=n.items).call(r,(function(t){e.items[t.id]=t})),e.batches[t[0].batchId].batchOptions=n.options}));var u=e.getState();n.items=Ge()(r=n.items).call(r,(function(e){return u.items[e.id]})),n.options=u.batches[t[0].batchId].batchOptions}return n}))},zn=function(e,t,n){var r,u=t.items,o=t.options,a=e.getState().batches[u[0].batchId].batch;try{r=e.sender.send(u,a,o)}catch(e){D.debugLog("uploader.queue: sender failed with unexpected error",e),r={request:U.a.resolve({status:0,state:C.c.ERROR,response:e.message}),abort:function(){return!1},senderType:"exception-handler"}}return function(e,t,n){e.updateState((function(e){J()(t).call(t,(function(t){e.items[t.id].state=C.c.UPLOADING,e.aborts[t.id]=n.abort}))}))}(e,u,r),r.request.then((function(t){var r=Ge()(u).call(u,(function(e){return{id:e.id,info:t}}));Fn(e,r,n)}))},Gn=function(e,t,n){var r=e.getState(),u=Ht()(r.items);return u=kt()(u).call(u,(function(e){return!!~se()(t).call(t,e.id)})),U.a.all(Ge()(u).call(u,(function(t){return e.runCancellable(In.ITEM_START,t)}))).then((function(t){var n;return{allowedItems:kt()(n=Ge()(t).call(t,(function(t,n){return t?null:function(e,t){return t.getState().items[e]}(u[n].id,e)}))).call(n,Boolean),cancelledResults:t}})).then((function(r){var o=r.allowedItems,a=r.cancelledResults;return(o.length?qn(e,o).then():U.a.resolve()).then((function(r){var o;return r&&(r.cancelled?a=Ge()(t).call(t,(function(){return!0})):zn(e,r,n)),function(e,t,n,r){var u,o=kt()(u=Ge()(n).call(n,(function(e,n){return e?t[n].id:null}))).call(u,Boolean);if(o.length){var a=Ge()(o).call(o,(function(e){return{id:e,info:{status:0,state:C.c.CANCELLED,response:"cancel"}}}));Fn(e,a,r)}return!!o.length}(e,u,a,n)||(o=n(e)),o}))}))},Kn=function(e,t){var n,r;return!!~se()(n=Ft()(r=e.getState().activeIds).call(r)).call(n,t)},Xn=function(e){var t,n=e.getState().itemQueue,r=function(e){for(var t=e.getState(),n=t.itemQueue,r=t.items,u=0,o=n[u];o&&(Kn(e,o)||!jn(e,o)||r[o].state!==C.c.ADDED);)o=n[u+=1];return o?u:-1}(e),u=n[r];if(u){var o=An(e,u),a=o.batch.id,i=o.batchOptions.maxGroupSize||0;if(o.batchOptions.grouped&&i>1){t=[];for(var c=!0;t.length<i&&c;)t.push(u),c=(u=n[r+t.length])&&Tn(e,u,a)}else t=[u]}return t},Wn=function(e){var t=Xn(e),n=U.a.resolve();if(t){var r=e.getCurrentActiveCount(),u=e.getOptions(),o=u.concurrent,a=void 0===o?0:o,i=u.maxConcurrent;if(!r||a&&r<(void 0===i?0:i)){D.debugLog("uploader.processor: Processing next upload - ",{ids:t,state:e.getState(),currentCount:r});var c=!1,l=U.a.resolve(!1);Un(e,t[0])&&(l=function(e,t){var n=wn(e,t);return e.runCancellable(In.BATCH_START,n).then((function(t){return t||e.updateState((function(e){e.currentBatch=n.id})),!t}))}(e,t[0]).then((function(n){return(c=!n)&&(!function(e,t){var n=wn(e,t),r=n.id;D.debugLog("uploady.uploader.processor: cancelling batch: ",{batch:n}),e.updateState((function(e){Dn(e,r).state=C.a.CANCELLED})),Nn(e,r,In.BATCH_CANCEL),_n(e,r),Pn(e,r)}(e,t[0]),Wn(e)),c}))),n=l.then((function(n){n||Gn(e,t,Wn)}))}}return n},Qn=Wn,Vn=function(e,t,n,r){return D.debugLog("uploader.queue: aborting ".concat(t.state," item  - "),t),Fn(e,[{id:t.id,info:{status:0,state:C.c.ABORTED,response:"aborted"}}],n),r||Bn(e,t.batchId),!0},Yn=(dn={},Ct()(dn,C.c.UPLOADING,(function(e,t){return D.debugLog("uploader.queue: aborting uploading item  - ",t),e.getState().aborts[t.id]()})),Ct()(dn,C.c.ADDED,Vn),Ct()(dn,C.c.PENDING,Vn),dn),Zn=function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],u=e.getState(),o=u.items[t],a=null==o?void 0:o.state;return!!Yn[a]&&Yn[a](e,o,n,r)},Jn=function(e,t,n){var r,u=e.getState().batches[t],o=null==u?void 0:u.batch;o&&function(e){return e.state!==C.a.CANCELLED&&e.state!==C.a.FINISHED}(o)&&(J()(r=o.items).call(r,(function(t){return Zn(e,t.id,n,!0)})),e.updateState((function(e){Dn(e,t).state=C.a.ABORTED})),Nn(e,t,In.BATCH_ABORT),Bn(e,o.id))},$n=function(e,t,n,r,u){var o=it({itemQueue:[],currentBatch:null,batches:{},items:{},activeIds:[],aborts:{}}),a=o.state,i=o.update,c=function(){return a},l=function(e){i(e)},d=function(e){if(a.items[e.id]&&!e.recycled)throw new Error("Uploader queue conflict - item ".concat(e.id," already exists"));e.recycled&&function(e,t){var n=t.previousBatch;if(t.recycled&&n&&e.getState().batches[n]){var r=wn(e,t.id).id;r===n&&e.updateState((function(e){var n,u,o=Dn(e,r),a=A()(n=o.items).call(n,(function(e){return e.id===t.id}));~a&&We()(u=o.items).call(u,a,1)}))}}(f,e),l((function(t){t.items[e.id]=e,t.itemQueue.push(e.id)}))},s=function(e,n,r){a.items[e.id]&&(l((function(t){var u=t.items[e.id];u.loaded=r,u.completed=n})),t(In.ITEM_PROGRESS,c().items[e.id]))};r.on(Rn.ITEM_PROGRESS,s),r.on(Rn.BATCH_PROGRESS,(function(e){var n,r=null===(n=a.batches[e.id])||void 0===n?void 0:n.batch.items;if(r){var u=ae()(r).call(r,(function(e,t){return e[0]+=t.completed,e[1]+=t.loaded,e}),[0,0]),o=ne()(u,2),i=o[0],c=o[1];l((function(t){var n=t.batches[e.id].batch;n.completed=i/r.length,n.loaded=c})),t(In.BATCH_PROGRESS,a.batches[e.id].batch)}}));var f={getOptions:function(){return e},getCurrentActiveCount:function(){return a.activeIds.length},getState:c,updateState:l,trigger:t,runCancellable:function(e){var t;if(!Object(le.e)(n))throw new Error("cancellable is of wrong type");for(var r=arguments.length,u=new Array(r>1?r-1:0),o=1;o<r;o++)u[o-1]=arguments[o];return n.apply(void 0,_()(t=[e]).call(t,u))},sender:r,handleItemProgress:s};return Object(le.d)()&&D.isDebugOn()&&(window["__rpldy_".concat(u,"_queue_state")]=f),{updateState:l,getState:f.getState,runCancellable:f.runCancellable,uploadBatch:function(e,t){t&&l((function(n){n.batches[e.id].batchOptions=t})),Qn(f)},addBatch:function(e,t){var n;return l((function(n){n.batches[e.id]={batch:e,batchOptions:t}})),J()(n=e.items).call(n,d),Dn(a,e.id)},abortItem:function(e){return function(e,t,n){return Zn(e,t,n)}(f,e,Qn)},abortBatch:function(e){Jn(f,e,Qn)},abortAll:function(){var e,t,n,r;t=Qn,r=(e=f).getState().items,J()(n=Y()(r)).call(n,(function(n){return Zn(e,n,t)})),e.trigger(In.ALL_ABORT)},clearPendingBatches:function(){var e,t,n,r;r=(e=f).getState().batches,J()(t=kt()(n=Y()(r)).call(n,(function(e){return r[e].batch.state===C.a.PENDING}))).call(t,(function(t){_n(e,t),Pn(e,t)}))},uploadPendingBatches:function(e){!function(e,t){e.updateState((function(e){var n;J()(n=Y()(e.batches)).call(n,(function(n){var r,u=e.batches[n],o=u.batch,a=u.batchOptions;o.state===C.a.PENDING&&(J()(r=o.items).call(r,(function(e){e.state=C.c.ADDED})),o.state=C.a.ADDED,u.batchOptions=Object(le.i)({},a,t))}))}))}(f,e),Qn(f)}}},er=function(){return!0},tr=Object(le.b)({autoUpload:!0,clearPendingOnAdd:!1,inputFieldName:"file",concurrent:!1,maxConcurrent:2,grouped:!1,maxGroupSize:5,method:"POST",params:{},fileFilter:er,forceJsonResponse:!1,withCredentials:!1,destination:{},send:null,sendWithFormData:!0}),nr=function(e,t,n,r){!function(e,t,n,r){J()(e).call(e,(function(e){var u,o;D.debugLog(_()(u=_()(o="uploady.uploader.processor: file: ".concat(e.id," progress event: loaded(")).call(o,n,") - completed(")).call(u,t,")")),r(Rn.ITEM_PROGRESS,e,t,n)}))}(e,Math.min(n.loaded/n.total*100,100)/e.length,n.loaded/e.length,r),r(Rn.BATCH_PROGRESS,t)},rr=function(){var e=pn({send:function(e,n,r){var u=r.destination,o=null==u?void 0:u.url,a=L()((function(r){return nr(e,n,r,t)}),50,!0);return(Object(le.e)(r.send)?r.send:je)(e,o,{method:(null==u?void 0:u.method)||r.method||tr.method,paramName:(null==u?void 0:u.filesParamName)||r.inputFieldName||"file",params:ve()(ve()({},r.params),null==u?void 0:u.params),forceJsonResponse:r.forceJsonResponse,withCredentials:r.withCredentials,formatGroupParamName:r.formatGroupParamName,headers:null==u?void 0:u.headers,sendWithFormData:r.sendWithFormData},a)}},Ht()(Rn)),t=e.trigger;return e.target},ur=Object(le.d)()&&"FileList"in window,or=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=e;if(!Object(le.g)())if(t<3&&et(e))n=at(e);else if(t<3&&tt(e)){var r,u;n=Ze()(e)?Ge()(r=Y()(e)).call(r,(function(t){return or(e[t])})):ae()(u=Y()(e)).call(u,(function(n,r){return n[r]=or(e[r],t+1),n}),{})}return n},ar=0,ir=function(e,t,n,r){var u;return Ge()(u=kt()(Array.prototype).call(t,r||er)).call(u,(function(t){return Q(t,e,n)}))},cr=function(e,t,n){var r="batch-".concat(ar+=1),u=function(e){return ur&&e instanceof FileList||"[object FileList]"===e.toString()}(e);e=Ze()(e)||u?e:[e];var o=!n.autoUpload;return{id:r,uploaderId:t,items:ir(r,e,o,n.fileFilter),state:o?C.a.PENDING:C.a.ADDED,completed:0,loaded:0}},lr=Ht()(In),dr=0,sr=function(e){var t="uploader-".concat(dr+=1),n=!1,r={};D.debugLog("uploady.uploader: creating new instance (".concat(t,")"),{options:e,counter:dr});var u=function(e){return ve()(ve()(ve()({},tr),e),{},{destination:e&&e.destination?(t=e.destination,ve()({params:{}},t)):null});var t}(e),o=function(){f.clearPendingBatches()},a=pn({id:t,update:function(e){return u=Object(le.i)({},u,e),c},add:function(e,t){var n=Object(le.i)({},u,t);n.clearPendingOnAdd&&o();var r,a=f.addNewBatch(e,c.id,n);return a.items.length?r=f.runCancellable(In.BATCH_ADD,a,n).then((function(e){var t;e?(a.state=C.a.CANCELLED,l(In.BATCH_CANCEL,a)):(D.debugLog(_()(t="uploady.uploader [".concat(c.id,"]: new items added - auto upload =\n                        ")).call(t,String(n.autoUpload)),a.items),n.autoUpload&&f.process(a))})):D.debugLog("uploady.uploader: no items to add. batch ".concat(a.id," is empty. check fileFilter if this isn't intended")),r||U.a.resolve()},upload:function(e){f.processPendingBatches(e)},abort:function(e){f.abort(e)},abortBatch:function(e){f.abortBatch(e)},getOptions:function(){return Object(le.a)(u)},clearPending:o,registerExtension:function(e,t){I()(n,"Uploady - uploader extensions can only be registered by enhancers"),I()(!r[e],"Uploady - uploader extension by this name [%s] already exists",e),D.debugLog("uploady.uploader: registering extension: ".concat(e.toString()),t),r[e]=t},getExtension:function(e){return r[e]}},lr,{canAddEvents:!1,canRemoveEvents:!1}),i=a.trigger,c=a.target,l=function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var u=gn((function(){return Ge()(n).call(n,or)}));return i(e,u)},d=k(l);if(u.enhancer){n=!0;var s=u.enhancer(c,l);n=!1,c=s||c}var f=function(e,t,n,r){var u=rr(),o=$n(n,e,t,u,r);return{process:function(e,t){o.uploadBatch(e,t)},abortBatch:function(e){o.abortBatch(e)},abort:function(e){e?o.abortItem(e):o.abortAll()},addNewBatch:function(e,t,n){var r=cr(e,t,n);return o.addBatch(r,n)},runCancellable:o.runCancellable,clearPendingBatches:function(){o.clearPendingBatches()},processPendingBatches:function(e){o.uploadPendingBatches(e)}}}(l,d,u,c.id);return Object(le.b)(c)},fr=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return function(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),u=1;u<n;u++)r[u-1]=arguments[u];return ae()(t).call(t,(function(e,t){var n;return t.apply(void 0,_()(n=[e]).call(n,r))||e}),e)}},pr=sr,gr=q()("__upldy-retry__"),vr="RETRY_EVENT",hr=[C.c.ABORTED,C.c.ERROR],br=function(e,t,n,r,u){var o,a=t.getState().failed;r=r||Y()(a);var i,c=kt()(o=Ge()(r).call(r,(function(e){return a[e]}))).call(o,Boolean);c.length&&(u=ve()(ve()({},u||null),{},{autoUpload:void 0===(null===(i=u)||void 0===i?void 0:i.autoUpload)||u.autoUpload}),n(vr,{items:c,options:u}),J()(r).call(r,(function(e){return function(e,t){e.updateState((function(e){var n,r,u=e.failed[t].batchId;delete e.failed[t];var o=se()(n=e.batchIdsMap[u]).call(n,t);We()(r=e.batchIdsMap[u]).call(r,o,1),e.batchIdsMap[u].length||delete e.batchIdsMap[u]}))}(t,e)})),e.add(c,u));return!!c.length},mr=function(e,t,n,r,u){var o;return r?o=function(e,t,n,r,u){return D.debugLog("uploady.retry: about to retry item: ".concat(r)),br(e,t,n,[r],u)}(e,t,n,r,u):(D.debugLog("uploady.retry: about to retry all failed item"),o=br(e,t,n,null,u)),o},Sr=function(e,t){var n,r,u,o=(n=it({batchIdsMap:{},failed:{}}),r=n.state,u=n.update,{updateState:function(e){u(e)},getState:function(){return r}});return function(e,t){e.on(In.ITEM_FINALIZE,(function(e){~se()(hr).call(hr,e.state)&&t.updateState((function(t){t.failed[e.id]=e,(t.batchIdsMap[e.batchId]=t.batchIdsMap[e.batchId]||[]).push(e.id)}))}))}(e,o),e.registerExtension(gr,{retry:function(n,r){return mr(e,o,t,n,r)},retryBatch:function(n,r){return function(e,t,n,r,u){var o;D.debugLog("uploady.retry: about to retry batch: ".concat(r));var a=null===(o=t.getState().batchIdsMap[r])||void 0===o?void 0:pe()(o).call(o);return!!a&&br(e,t,n,a,u)}(e,o,t,n,r)}}),e},Er=n("MAKL"),yr=n.n(Er),Or=function(e){var t=!1;!function(){try{if(Object(le.d)()&&e in window){window[e].setItem("__lsTest","__test-".concat(yr()())),window[e].removeItem("__lsTest"),t=!0}}catch(e){}}();var n=["key","getItem","setItem","removeItem","clear"],r=ae()(n).call(n,(function(n,r){return n[r]=function(){var n;return t?(n=window[e])[r].apply(n,arguments):null},n}),{});return r.isSupported=t,H()(r,"length",{get:function(){return t?window[e].length:0}}),r},Ir=Or("localStorage"),Rr=Or("sessionStorage"),Lr=Object(le.b)(ve()(ve()({},Be),{},{featureDetection:!1,featureDetectionUrl:null,version:"1.0.0",resume:!0,overrideMethod:!1,deferLength:!1,sendDataOnCreate:!1,storagePrefix:"__rpldy-tus__",lockedRetryDelay:2e3,forgetOnSuccess:!1,ignoreModifiedDateInStorage:!1})),Cr=n("WxoT"),Dr=n.n(Cr),Tr=function(e,t,n){var r,u,o=kt()(r=[e.file.name,e.file.type,e.file.size,t.ignoreModifiedDateInStorage?null:e.file.lastModified,n]).call(r,Boolean).join("/");return _()(u="".concat(t.storagePrefix||Lr.storagePrefix)).call(u,o)},Ar=function(e,t,n,r){n.resume&&Ir.setItem(Tr(e,n,r),Dr()({time:yr()(),uploadUrl:t}))},wr=function(e,t,n){var r,u=Tr(e,t,n);if(t.resume)try{var o=Ir.getItem(u);if(o)r=JSON.parse(o).uploadUrl}catch(e){D.debugLog("tusSender.resumableStore: failed to retrieve persisted data for key: ".concat(u),e)}return r},_r=function(e,t,n){var r=Tr(e,t,n);Ir.removeItem(r)},Pr=function(e){for(var t=e.storagePrefix||Lr.storagePrefix,n=0;n<Ir.length;n++){var r=Ir.key(n);r&&!se()(r).call(r,t)&&Ir.removeItem(r)}},Ur=n("lHQ6"),kr=n.n(Ur),Nr=q()("__upldy-tus__"),jr="rpldy-tus-sender",Br=[200,201,204],Hr="creation-with-upload",xr="concatenation",Fr="creation-defer-length",Mr=function(e){var t=e.params&&Y()(e.params);return(null==t?void 0:t.length)?Ge()(t).call(t,(function(t){var n;return _()(n="".concat(t," ")).call(n,btoa(e.params[t]))})).join(","):void 0},qr=function(e,t){return e.then((function(e){return e.state===C.c.FINISHED&&(e.response.location=t),e}))},zr=function(e,t,n,r,u){var o,a=n.getState().options,i=ve()({"tus-resumable":a.version,"Upload-Defer-Length":a.deferLength?1:void 0,"Upload-Length":a.deferLength?void 0:e.file.size,"Upload-Metadata":u?void 0:Mr(r),"Content-Type":a.sendDataOnCreate?"application/offset+octet-stream":void 0},r.headers),c=null;if(D.debugLog(_()(o="tusSender.create - creating upload for ".concat(e.id," at: ")).call(o,t)),a.sendDataOnCreate){D.debugLog("tusSender.create - adding first chunk to create request");var l=+a.chunkSize;c=l<e.file.size?Fe(e.file,0,l):e.file}var d=ce(t,c,{method:"POST",headers:i}),s=!1;return{request:d.then((function(r){var u=null;return r&&~se()(Br).call(Br,r.status)?u=function(e,t,n,r,u){var o,a,i,c=n.getState().options,l=(a=t,i=r.getResponseHeader("Location"),/^(http:|https:)?\/\//.test(i)?i:[a.replace(/\/$/,""),i.replace(/^\//,"")].join("/")),d=0,s=!1;if(D.debugLog(_()(o="tusSender.create: successfully created upload for item: ".concat(e.id," - upload url = ")).call(o,l)),c.sendDataOnCreate){var f=kr()(r.getResponseHeader("Upload-Offset"));d=isNaN(f)?d:f,s=+c.parallel>1&&d===(null==u?void 0:u.size)}return n.updateState((function(t){t.items[e.id].uploadUrl=l,t.items[e.id].offset=d})),{offset:d,uploadUrl:l,isNew:!0,isDone:s}}(e,t,n,r,c):D.debugLog("tusSender.create: create upload failed for item: ".concat(e.id),r),u})).catch((function(e){return D.debugLog("tusSender.create: create upload failed",e),null})).finally((function(){s=!0})),abort:function(){return s||(D.debugLog("tusSender.create: aborting create request for item: ".concat(e.id)),d.xhr.abort()),!s}}},Gr=function(e,t,n){return _r(e,t,n),{isNew:!1,canResume:!1}},Kr=function(e,t,n,r,u){var o,a,i=n.getState().options;D.debugLog(_()(o=_()(a="tusSender.resume - resuming upload for ".concat(e.id)).call(a,r?"-".concat(r):""," at: ")).call(o,t));var c=ce(t,null,{method:"HEAD",headers:{"tus-resumable":i.version}}),l=!1;return{request:c.then((function(o){var a;if(o&&~se()(Br).call(Br,o.status))a=function(e,t,n,r){var u,o=!1,a=!1;D.debugLog(_()(u="tusSender.resume - successfully initiated resume for item: ".concat(e.id," - upload url = ")).call(u,t));var i=kr()(r.getResponseHeader("Upload-Offset"));if(!isNaN(i)){var c=kr()(r.getResponseHeader("Upload-Length"));isNaN(c)&&!n.getState().options.deferLength||(o=!(a=i===c),n.updateState((function(n){n.items[e.id].uploadUrl=t,n.items[e.id].offset=i})))}return{offset:i,uploadUrl:t,isNew:!1,isDone:a,canResume:o}}(e,t,n,o);else if(423===(null==o?void 0:o.status)&&0===u){var c;D.debugLog(_()(c="tusSender.resume: upload is locked for item: ".concat(e.id,". Will retry in ")).call(c,+i.lockedRetryDelay),o),a=function(e,t,n,r,u){return new U.a((function(o){bn()((function(){Kr(e,t,n,r,u).request.then(o)}),n.getState().options.lockedRetryDelay)}))}(e,t,n,r,1)}else{var l;D.debugLog(_()(l="tusSender.resume: failed for item: ".concat(e.id)).call(l,r?"-".concat(r):""),o),a=Gr(e,i,r)}return a})).catch((function(t){return D.debugLog("tusSender.resume: resume upload failed unexpectedly",t),Gr(e,i,r)})).finally((function(){l=!0})),abort:function(){return l||(D.debugLog("tusSender.resume: aborting resume request for item: ".concat(e.id)),c.xhr.abort()),!l}}},Xr=function(e,t,n,r){return Kr(e,t,n,r,0)},Wr=function(e,t,n,r,u){return u.then((function(u){var o=u;if(u.state===C.c.FINISHED){var a=n.getState(),i=a.options,c=a.items,l=c[e.id];if(l){var d,s,f=l.parallelChunks,p=Ge()(d=kt()(f).call(f,(function(e){var t;return null===(t=c[e])||void 0===t?void 0:t.uploadUrl}))).call(d,(function(e){return c[e].uploadUrl}));if(p.length!==f.length)throw new Error(_()(s="tusSender: something went wrong. found ".concat(p.length," upload urls for ")).call(s,f.length," chunks"));var g={"tus-resumable":i.version,"Upload-Concat":"final;".concat(p.join(" ")),"Upload-Metadata":Mr(r)};D.debugLog("tusSender.finalizeParallel: sending finalizing request",{url:t,headers:g});var v=ce(t,null,{method:"POST",headers:g});n.updateState((function(t){t.items[e.id].abort=function(){return v.xhr.abort(),!0}})),o=function(e,t){return e.catch((function(e){return D.debugLog("tusSender.finalizeParallel: finalize request failed unexpectedly!",e),e})).then((function(e){var n,r=(null==e?void 0:e.status)||0,u=!!~se()(Br).call(Br,r),o=u&&(null==e?void 0:e.getResponseHeader)&&e.getResponseHeader("Location");return o?(D.debugLog("tusSender.finalizeParallel: successfully finalized parallel upload",o),n=qr(U.a.resolve(t),o)):(D.debugLog("tusSender.finalizeParallel: parallel upload finalize failed!",r),n={status:r,state:C.c.ERROR,response:{message:(null==e?void 0:e.response)||(u&&!o?"No valid location header for finalize request":"")}}),n}))}(v,u)}}return o}))},Qr=function(e,t,n,r,u,o,a,i,c){return a.then((function(a){var l,d=!1;if(a?a.isDone?(D.debugLog("tusSender.handler: resume found server has completed file for item: ".concat(e[0].id),e[0]),l=qr(U.a.resolve({status:200,state:C.c.FINISHED,response:{message:"TUS server has file"}}),a.uploadUrl)):a.isNew||a.canResume?l=c?function(e,t,n,r){var u=e[0];return n.uploadUrl&&Ar(u,n.uploadUrl,t.getState().options,r),D.debugLog("tusSender.handler: created upload for parallelized chunk: ".concat(u.id)),U.a.resolve({status:200,state:C.c.UPLOADING,response:"TUS server created upload for parallelized part"})}(e,u,a,c):function(e,t,n,r,u,o,a){var i=u.getState().options,c=e[0];D.debugLog("tusSender.handler: init request finished. sending item ".concat(c.id," as chunked"),a),a.isNew&&a.uploadUrl&&Ar(c,a.uploadUrl,i),(a.canResume||i.sendDataOnCreate&&a.offset)&&(n=ve()(ve()({},n),{},{startByte:a.offset}));var l=o.send(e,t,n,r);return u.updateState((function(e){e.items[c.id].abort=l.abort})),+i.parallel>1?Wr(c,t,u,n,l.request):qr(l.request,a.uploadUrl)}(e,t,n,r,u,o,a):d=!0:d=i,d){D.debugLog("tusSender.handler: resume init failed. Will try creating a new upload for item: ".concat(e[0].id));var s=zr(e[0],t,u,n).request;l=Qr(e,t,n,r,u,o,s)}return l||U.a.resolve({status:0,state:C.c.ERROR,response:"TUS initialize failed"})}))},Vr=Qr,Yr=function(e,t){t.updateState((function(t){t.items[e.id]={id:e.id,uploadUrl:null,size:e.file.size,offset:0,parallelChunks:[]}}))},Zr=function(e,t,n,r,u,o){var a,i=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,c=u.getState(),l=c.options,d=+l.parallel>1&&!i,s=e[0],f=!d&&wr(s,l,i);Yr(s,u),a=d?{request:U.a.resolve({isNew:!0}),abort:function(){return!0}}:f?Xr(s,f,u,i):zr(s,t,u,n,i);var p=Vr(e,t,n,r,u,o,a.request,!!f,i),g=function(){return D.debugLog("tusSender.handler: abort called for item: ".concat(s.id)),a.abort(),a.request.then((function(e){if(e){D.debugLog("tusSender.handler: aborting chunked upload for item:  ".concat(s.id));var t=u.getState().items[s.id].abort;t&&t()}})),!0};return{request:p,abort:g}},Jr=function(e,t){var n;return _()(n="_prlChunk_".concat(+e.chunkSize,"_")).call(n,t)},$r=function(e,t,n){xe&&(e.on(In.ITEM_FINALIZE,(function(e){var n=t.getState(),r=n.items,u=n.options,o=r[e.id];if(o){var a;D.debugLog(_()(a="tusSender.handleEvents: item ".concat(e.id," finalized (")).call(a,e.state,"). Removing from state"));var i=o.parallelChunks;t.updateState((function(t){i.length&&J()(i).call(i,(function(e){delete t.items[e]})),delete t.items[e.id]})),u.forgetOnSuccess&&(D.debugLog("tusSender.handleEvents: forgetOnSuccess enabled, removing item url from storage: ".concat(e.id)),_r(e,u))}})),e.on(ct.CHUNK_START,(function(e){var r=+t.getState().options.parallel>1;return(r?function(e,t,n){var r=n.item,u=n.chunkItem,o=n.url,a=n.sendOptions,i=n.onProgress,c=n.chunk,l=e.getState().options;return e.updateState((function(e){e.items[r.id].parallelChunks.push(u.id)})),Zr([u],o,ve()(ve()({},a),{},{params:null}),i,e,t,Jr(l,c.index)).request.then((function(e){return e.state!==C.c.FINISHED}))}(t,n,e):U.a.resolve(!0)).then((function(n){return n&&function(e,t,n){var r=t.item,u=t.chunk,o=t.chunkItem,a=t.chunkCount,i=e.getState().options,c=e.getState().items[n?o.id:r.id],l=n?0:c.offset||u.start,d={"tus-resumable":i.version,"Upload-Offset":l,"Content-Type":"application/offset+octet-stream","Content-Range":void 0,"X-HTTP-Method-Override":i.overrideMethod?"PATCH":void 0,"Upload-Length":i.deferLength&&u.index===a-1?r.file.size:void 0,"Upload-Concat":n?"partial":void 0};return D.debugLog("tusSender.handleEvents: chunk start handler. offset = ".concat(l),{headers:d,url:c.uploadUrl}),{sendOptions:{sendWithFormData:!1,method:i.overrideMethod?"POST":"PATCH",headers:d},url:c.uploadUrl}}(t,e,r)}))})),e.on(ct.CHUNK_FINISH,(function(e){var n=e.item,r=e.chunk,u=e.uploadData,o=t.getState(),a=o.items,i=o.options;if(+i.parallel>1){if(i.forgetOnSuccess){var c=Jr(i,r.index);D.debugLog("tusSender.handleEvents: forgetOnSuccess enabled, removing parallel chunk url from storage: ".concat(c)),_r(n,i,c)}}else if(a[n.id]){var l,d,s=u.status,f=u.response;D.debugLog(_()(l=_()(d="tusSender.handleEvents: received upload response (code: ".concat(s,") for : ")).call(d,n.id,", chunk: ")).call(l,r.id),f),~se()(Br).call(Br,s)&&f.headers&&t.updateState((function(e){e.items[n.id].offset=f.headers["upload-offset"]}))}})))},eu=function(e){var t;return _()(t="".concat("rpldy_tus_fd_")).call(t,e)},tu=(sn={},Ct()(sn,xr,(function(e,t){+t.getState().options.parallel>1&&!~se()(e).call(e,xr)&&(D.debugLog("tusSender.featureDetection: disabling parallel uploads, ".concat(xr," extension not available")),t.updateState((function(e){e.options.parallel=1})))})),Ct()(sn,Hr,(function(e,t){t.getState().options.sendDataOnCreate&&!~se()(e).call(e,Hr)&&(D.debugLog("tusSender.featureDetection: disabling create with data, ".concat(Hr," extension not available")),t.updateState((function(e){e.options.sendDataOnCreate=!1})))})),Ct()(sn,Fr,(function(e,t){t.getState().options.deferLength&&!~se()(e).call(e,Fr)&&(D.debugLog("tusSender.featureDetection: disabling defer length, ".concat(Fr," extension not available")),t.updateState((function(e){e.options.deferLength=!1})))})),sn),nu=function(e,t,n){var r=e.getState().options;if(t){D.debugLog("tusSender.featureDetection: retrieved extensions from server",t);var u=t.split(",");if(u.length&&r.onFeaturesDetected){var o=r.onFeaturesDetected(u);o&&e.updateState((function(e){e.options=Object(le.i)({},e.options,o)}))}else{var a;J()(a=Y()(tu)).call(a,(function(t){tu[t](u,e)}))}}n&&n!==e.getState().options.version&&(D.debugLog("tusSender.featureDetection: setting version to server version: ".concat(n)),e.updateState((function(e){e.options.version=n}))),e.updateState((function(e){e.featureDetection={processed:!0,version:n,extensions:t}}))},ru=function(e,t,n){return e.catch((function(e){D.debugLog("tusSender.featureDetection: failed to retrieve data from server",e)})).then((function(e){if(e&&~se()(Br).call(Br,e.status)){var r=e.getResponseHeader("Tus-Extension"),u=e.getResponseHeader("Tus-Resumable");r&&Rr.setItem(eu(t),Dr()({extensions:r,versions:u})),nu(n,r,u)}}))},uu=function(e,t){var n=t.getState().options,r=ce(e,null,{method:"OPTIONS",headers:{"tus-resumable":n.version}});return{request:ru(r,e,t),abort:function(){return r.xhr.abort(),!0}}},ou=function(e,t){var n,r=t.getState(),u=r.options,o=r.featureDetection;e=u.featureDetectionUrl||e,D.debugLog("tusSender.featureDetection: about to request server info",e);var a=Rr.getItem(eu(e));return o.processed||(n=a?function(e,t,n){var r;try{(r=JSON.parse(n)).extensions?(D.debugLog("tusSender.featureDetection: retrieved feature detection data from session storage",r),nu(t,r.extensions,r.version)):r=null}catch(e){D.debugLog("tusSender.featureDetection: failed to load feature detection data from session storage")}return r||Rr.removeItem(eu(e)),r?null:uu(e,t)}(e,t,a):uu(e,t)),n},au=function(e,t){return xe?function(n,r,u,o){var a;if(!r)throw new Le(jr);if(n.length>1||n[0].url)a=e.send(n,r,u,o);else{D.debugLog("tusSender: sending file using TUS protocol");var i=t.getState().options.featureDetection?ou(r,t):null,c=function(e,t,n,r,u,o,a){var i,c=function(){var a=Zr(e,t,n,r,u,o);return i=a.abort,a.request};return{request:a?a.request.then(c,c):c(),abort:function(){return i?i():(null==a?void 0:a.abort())||!1}}}(n,r,u,o,t,e,i);a={request:c.request,abort:c.abort,senderType:jr}}return a}:je},iu=function(e){return((e=function(e){return Object(le.i)({},Lr,e)}(e)).sendDataOnCreate||e.parallel)&&e.deferLength&&(D.debugLog("tusSender: turning off deferLength - cannot be used when sendDataOnCreate or parallel is enabled"),e.deferLength=!1),e.chunked=!0,e},cu=function(e,t,n){t=iu(t);var r=Ot(t,n),u=function(e,t){var n=it({options:t,items:{},featureDetection:{extensions:null,version:null,processed:!1}}),r=n.state,u={getState:function(){return r},updateState:n.update};return Object(le.d)()&&D.isDebugOn()&&(window["__rpldy_".concat(e.id,"_tus_state")]=u),u}(e,t);return $r(e,u,r),{send:au(r,u),getOptions:function(){return u.getState().options}}},lu=function(e){return function(t,n){var r=cu(t,e,n);return t.update({send:r.send}),t.registerExtension(Nr,{getOptions:r.getOptions}),t}},du=lu,su=n("EcSs"),fu=n.n(su),pu=n("tpxy"),gu=n.n(pu),vu=n("cDcd"),hu=n.n(vu),bu=function(e,t){var n,r;t?n=t:D.debugLog("Uploady context - didn't receive input field ref - waiting for external ref");var u=function(){var e;return null===(e=n)||void 0===e?void 0:e.current},o=function(){var e=u();I()(e,"Uploady - Context. File input isn't available"),e.removeEventListener("change",o);var t=r;r=null,a(e.files,t)},a=function(t,n){e.add(t,n)};return{hasUploader:function(){return!!e},setExternalFileInput:function(e){n=e},showFileUpload:function(e){var t=u();I()(t,"Uploady - Context. File input isn't available"),r=e,t.removeEventListener("change",o),t.addEventListener("change",o),t.value="",t.click()},upload:a,processPending:function(t){e.upload(t)},clearPending:function(){e.clearPending()},setOptions:function(t){e.update(t)},getOptions:function(){return e.getOptions()},getExtension:function(t){return e.getExtension(t)},abort:function(t){e.abort(t)},abortBatch:function(t){e.abortBatch(t)},on:function(t,n){return e.on(t,n)},once:function(t,n){return e.once(t,n)},off:function(t,n){return e.off(t,n)}}},mu=hu.a.createContext(null),Su=function(e){return I()(e&&e.hasUploader(),"Uploady - valid UploadyContext not found. Make sure you render inside <Uploady>"),e},Eu=function(){return Su(Object(vu.useContext)(mu))},yu=function(e,t){var n=Eu(),r=n.on,u=n.off;Object(vu.useEffect)((function(){return r(e,t),function(){u(e,t)}}),[e,t,r,u])},Ou=function(e,t){return function(n,r){var u=Object(vu.useState)(null),o=ne()(u,2),a=o[0],i=o[1],c=Object(vu.useCallback)((function(e){if(!r||e.id===r){for(var u,o,a=arguments.length,c=new Array(a>1?a-1:0),l=1;l<a;l++)c[l-1]=arguments[l];if(i(t.apply(void 0,_()(u=[e]).call(u,c))),n)n.apply(void 0,_()(o=[e]).call(o,c))}}),[n,r]);return yu(e,c),a}},Iu=function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return function(n,r){var u=Object(vu.useCallback)((function(e){for(var u,o=arguments.length,a=new Array(o>1?o-1:0),i=1;i<o;i++)a[i-1]=arguments[i];return!n||t&&r&&e.id!==r?void 0:n.apply(void 0,_()(u=[e]).call(u,a))}),[n,r]);yu(e,u)}},Ru=function(e,t){Object(le.g)()||e||console.warn(t)},Lu=Iu(In.BATCH_ADD,!1),Cu=Iu(In.BATCH_START),Du=Iu(In.BATCH_FINISH),Tu=Iu(In.BATCH_CANCEL),Au=Iu(In.BATCH_ABORT),wu=Ou(In.BATCH_PROGRESS,(function(e){return ve()({},e)})),_u=Iu(In.ITEM_START),Pu=Iu(In.ITEM_FINISH),Uu=Iu(In.ITEM_CANCEL),ku=Iu(In.ITEM_ERROR),Nu=Iu(In.ITEM_ABORT),ju=Iu(In.ITEM_FINALIZE),Bu=Ou(In.ITEM_PROGRESS,(function(e){return ve()({},e)})),Hu=Iu(In.REQUEST_PRE_SEND,!1),xu=Iu(In.ALL_ABORT,!1),Fu=function(e){var t=Eu();return e&&t.setOptions(e),t.getOptions()},Mu=function(){var e=Eu();return Object(vu.useCallback)((function(t){return e.abort(t)}),[e])},qu=function(){var e=Eu();return Object(vu.useCallback)((function(t){return e.abortBatch(t)}),[e])},zu=function(){var e=Eu();return Object(vu.useCallback)((function(){return e.abort()}),[e])},Gu=function(e){var t=e.listeners,n=e.debug,r=e.children,u=e.inputRef,o=gu()(e,["listeners","debug","children","inputRef"]);D.setDebug(!!n),D.debugLog("@@@@@@ Uploady Rendering @@@@@@",e);var a=function(e,t){var n=Object(vu.useMemo)((function(){return D.debugLog("Uploady creating a new uploader instance",e),pr(e)}),[e.enhancer]);return n.update(e),Object(vu.useEffect)((function(){var e;t&&(D.debugLog("Uploady setting event listeners",t),J()(e=De()(t)).call(e,(function(e){var t=ne()(e,2),r=t[0],u=t[1];n.on(r,u)})));return function(){var e;t&&(D.debugLog("Uploady removing event listeners",t),J()(e=De()(t)).call(e,(function(e){var t=ne()(e,2),r=t[0],u=t[1];return n.off(r,u)})))}}),[t,n]),n}(o,t),i=Object(vu.useMemo)((function(){return bu(a,u)}),[a,u]);return hu.a.createElement(mu.Provider,{value:i},r)},Ku=function(e){return function(t){var n=Eu(),r=t.id,u=Object(vu.useState)({update:null,data:null}),o=ne()(u,2),a=o[0],i=o[1];return Object(vu.useLayoutEffect)((function(){var e=function(t){var u;return qt()(u=t.items).call(u,(function(e){return e.id===r}))&&new U.a((function(r){i((function(){return{update:function(t){n.off(In.REQUEST_PRE_SEND,e),r(t)},data:t}}))}))};return r&&n.on(In.REQUEST_PRE_SEND,e),function(){r&&n.off(In.REQUEST_PRE_SEND,e)}}),[n,r]),hu.a.createElement(e,fu()({},t,{updateRequest:a.update,requestData:a.data}))}},Xu=n("faye"),Wu=n.n(Xu),Qu=function(e,t,n){return hu.a.createElement("input",fu()({},e,{name:t.inputFieldName,type:"file",ref:n}))},Vu=Object(vu.memo)(Object(vu.forwardRef)((function(e,t){var n=e.container,r=e.noPortal,u=gu()(e,["container","noPortal"]),o=Fu(),a=n&&1===n.nodeType;return I()(a||!Object(le.d)(),"Uploady - Container for file input must be a valid dom element"),r?Qu(u,o,t):function(e,t,n,r,u){return e&&t?Wu.a.createPortal(Qu(n,r,u),e):null}(n,a,u,o,t)}))),Yu=function(e){var t=e.multiple,n=void 0===t||t,r=e.capture,u=e.accept,o=e.webkitdirectory,a=e.children,i=e.inputFieldContainer,c=e.customInput,l=e.fileInputId,d=e.noPortal,s=void 0!==d&&d,f=gu()(e,["multiple","capture","accept","webkitdirectory","children","inputFieldContainer","customInput","fileInputId","noPortal"]),p=c?null:i||(Object(le.d)()?document.body:null),g=Object(vu.useRef)();return hu.a.createElement(Gu,fu()({},f,{inputRef:g}),c?null:hu.a.createElement(Vu,{container:p,multiple:n,capture:r,accept:u,webkitdirectory:o,style:{display:"none"},ref:g,id:l,noPortal:s}),a)},Zu=n("pPxq"),Ju=n.n(Zu),$u=function(e){var t=e.closest("form"),n={filesParamName:e.getAttribute("name"),method:void 0,url:void 0};if(t){var r,u=t.getAttribute("method"),o=function(e){var t,n,r,u,o,a,i,c,l=window.location,d=e.getAttribute("action")||"";switch(d=d.replace(/\s/g,""),!0){case""===d:d=l.href;break;case Ju()(d).call(d,"/"):d=_()(t=_()(n="".concat(l.protocol,"//")).call(n,l.host)).call(t,d);break;case!/:\/\//.test(d):c=_()(r=pe()(u=l.pathname.split("/")).call(u,0,-1)).call(r,"").join("/"),d=_()(o=_()(a=_()(i="".concat(l.protocol,"//")).call(i,l.host)).call(a,c)).call(o,d)}return d}(t);n.method=u?u.toUpperCase():void 0,n.url=o,D.debugLog(_()(r="Uploady.useFileInput: using custom input's parent form url ".concat(n.url," and method ")).call(r,n.method||""))}return n},eo=function(e){var t=Eu();t.setExternalFileInput(e),Object(vu.useEffect)((function(){if(e.current&&e.current.closest){var n=e.current,r=t.getOptions();if(!r.destination||!r.destination.url){var u=$u(n);t.setOptions({destination:u})}}}),[e,t])},to=Yu;Ru(xe||!Object(le.d)(),"This browser doesn't support chunking. Consider using @rpldy/uploady instead");var no=function(e){var t=e.chunked,n=e.chunkSize,r=e.retries,u=e.parallel,o=gu()(e,["chunked","chunkSize","retries","parallel"]),a=Object(vu.useMemo)((function(){return xe?function(e,t){var n=Rt(e);return t?fr(n,t):n}({chunked:t,chunkSize:n,retries:r,parallel:u},e.enhancer):void 0}),[e.enhancer,t,n,r,u]);return hu.a.createElement(to,fu()({},o,{enhancer:a}))},ro=Iu(ct.CHUNK_START,!1),uo=Iu(ct.CHUNK_FINISH,!1),oo=no,ao="Uploady - retry was not registered. Make sure you used the enhancer",io=function(){var e=Eu().getExtension(gr);return I()(e,ao),e.retry},co=function(){var e=Eu().getExtension(gr);return I()(e,ao),e.retryBatch},lo=Iu(vr,!1),so=Sr;Ru(xe,"This browser doesn't support chunking. Consider using @rpldy/uploady instead");var fo=function(e){var t=e.chunked,n=e.chunkSize,r=e.retries,u=e.parallel,o=e.version,a=e.featureDetection,i=e.featureDetectionUrl,c=e.onFeaturesDetected,l=e.resume,d=e.deferLength,s=e.overrideMethod,f=e.sendDataOnCreate,p=e.storagePrefix,g=e.lockedRetryDelay,v=e.forgetOnSuccess,h=e.ignoreModifiedDateInStorage,b=gu()(e,["chunked","chunkSize","retries","parallel","version","featureDetection","featureDetectionUrl","onFeaturesDetected","resume","deferLength","overrideMethod","sendDataOnCreate","storagePrefix","lockedRetryDelay","forgetOnSuccess","ignoreModifiedDateInStorage"]),m=Object(vu.useMemo)((function(){return xe?function(e,t){var n=lu(e);return t?fr(n,t):n}({chunked:t,chunkSize:n,retries:r,parallel:u,version:o,featureDetection:a,featureDetectionUrl:i,onFeaturesDetected:c,resume:l,deferLength:d,overrideMethod:s,sendDataOnCreate:f,storagePrefix:p,lockedRetryDelay:g,forgetOnSuccess:v,ignoreModifiedDateInStorage:h},e.enhancer):void 0}),[e.enhancer,t,n,r,u,o,a,i,c,l,d,s,f,p,g,v,h]);return hu.a.createElement(to,fu()({},b,{enhancer:m}))},po=function(){var e=Eu().getExtension(Nr);return I()(e,"Uploady - tus was not registered. Make sure you used the enhancer"),function(){return Pr(e.getOptions())}},go=fo,vo=function(e){return Object(vu.forwardRef)((function(t,n){var r=Eu().showFileUpload,u=t.id,o=t.className,a=t.text,i=t.children,c=t.extraProps,l=t.onClick,d=gu()(t,["id","className","text","children","extraProps","onClick"]),s=Object(vu.useRef)();s.current=d;var f=Object(vu.useCallback)((function(e){r(s.current),null==l||l(e)}),[r,s,l]);return hu.a.createElement(e,fu()({ref:n,onClick:f,id:u,className:o,children:i||a||"Upload"},c))}))},ho=vo(Object(vu.forwardRef)((function(e,t){return hu.a.createElement("button",fu()({ref:t},e))}))),bo=ho,mo=n("ALC1"),So=Object(vu.forwardRef)((function(e,t){var n=Object(vu.useRef)(null);Object(vu.useImperativeHandle)(t,(function(){return n.current}),[]);var r=Eu().upload,u=e.className,o=e.id,a=e.children,i=e.onDragOverClassName,c=e.dropHandler,l=e.htmlDirContentParams,d=e.extraProps,s=gu()(e,["className","id","children","onDragOverClassName","dropHandler","htmlDirContentParams","extraProps"]),f=Object(vu.useRef)();f.current=s;var p=Object(vu.useCallback)((function(){n.current&&i&&n.current.classList.remove(i)}),[i,n]),g=Object(vu.useCallback)((function(e){return c?U.a.resolve(c(e)):Object(mo.getFilesFromDragEvent)(e,l||{})}),[c,l]),v=Object(vu.useCallback)((function(e){g(e).then((function(e){r(e,f.current)}))}),[r,g,f]),h=Object(vu.useCallback)((function(e){e.preventDefault(),n.current&&i&&n.current.classList.add(i)}),[i,n]),b=Object(vu.useCallback)((function(e){e.preventDefault(),e.persist(),p(),v(e)}),[p,v]),m=Object(vu.useCallback)((function(){p()}),[p]),S=Object(vu.useCallback)((function(e){e.preventDefault(),e.stopPropagation(),p()}),[p]);return hu.a.createElement("div",fu()({id:o,className:u,ref:n,onDragOver:h,onDrop:b,onDragLeave:m,onDragEnd:S},d),a)})),Eo=So,yo={IMAGE:"image",VIDEO:"video"},Oo=n("R8cT"),Io=n.n(Oo),Ro=Object(le.b)({rememberPreviousBatches:!1,loadFirstOnly:!1,maxPreviewImageSize:2e7,maxPreviewVideoSize:1e8,fallbackUrl:"",imageMimeTypes:["image/jpeg","image/webp","image/gif","image/png","image/apng","image/bmp","image/x-icon","image/svg+xml"],videoMimeTypes:["video/mp4","video/webm","video/ogg"]}),Lo=function(e,t){var n=Object(le.e)(e)?e(t):e;return"string"==typeof n&&(n={url:n,name:t.name,type:yo.IMAGE}),n},Co=function(e,t,n,r){var u;return t&&~se()(t).call(t,r.type)&&(!n||r.size<=n)&&(u={url:Io.a.createObjectURL(r),name:r.name,type:e}),u},Do=function(e,t,n){var r,u,o=!1;if(e.file){var a=e.file;(r=function(e,t){var n=Co(yo.IMAGE,t.imageMimeTypes,t.maxPreviewImageSize||0,e);return n||(n=Co(yo.VIDEO,t.videoMimeTypes,t.maxPreviewVideoSize||0,e)),n}(e.file,t))||(r=Lo(t.fallbackUrl,a),o=!0)}else r={url:e.url,name:e.url,type:yo.IMAGE};return r&&(u=Object(le.e)(n)?n(e,r.url,r.type):n),r&&ve()(ve()({},r),{},{id:e.id,isFallback:o,props:u})},To=function(e){var t,n=Object(vu.useState)([]),r=ne()(n,2),u=r[0],o=r[1],a=(t=e,ve()(ve()({},Ro),t)),i=Object(vu.useCallback)((function(){o([])}),[]);return Cu((function(t){var n,r,i,c,l,d=a.loadFirstOnly?pe()(n=t.items).call(n,0,1):t.items,s=kt()(r=Ge()(d).call(d,(function(t){return Do(t,a,e.previewComponentProps)}))).call(r,Boolean);o(e.rememberPreviousBatches?(i=u,c=s,l=[],J()(c).call(c,(function(e){var t=A()(i).call(i,(function(t){return t.id===e.id}));~t?We()(i).call(i,t,1,e):l.push(e)})),_()(i).call(i,l)):s)})),{previews:u,clearPreviews:i}},Ao=function(e){var t=e.PreviewComponent,n=e.previewMethodsRef,r=e.onPreviewsChanged,u=gu()(e,["PreviewComponent","previewMethodsRef","onPreviewsChanged"]),o=To(u),a=o.previews,i=o.clearPreviews,c=Object(vu.useCallback)((function(t){var n=t.target,r=Lo(e.fallbackUrl,n.src);r&&(n.src=r.url)}),[e.fallbackUrl]);return function(e,t,n,r){Object(vu.useImperativeHandle)(n,(function(){return{clear:t}}),[t]),Object(vu.useEffect)((function(){r&&r(e)}),[e,r])}(a,i,n,r),Ge()(a).call(a,(function(e){var n=e.id,r=e.url,u=e.type,o=e.name,a=e.isFallback,i=e.props;return t?hu.a.createElement(t,fu()({key:n+r,id:n,url:r,type:u,name:o,isFallback:a},i)):function(e,t,n,r){return e===yo.VIDEO?hu.a.createElement("video",fu()({key:t,src:t,controls:!0},n)):hu.a.createElement("img",fu()({key:t,onError:r,src:t},n))}(u,r,i,c)}))},wo=Ao,_o=Object(vu.forwardRef)((function(e,t){var n=Object(vu.useRef)(null),r=Eu(),u=e.className,o=e.id,a=e.placeholder,i=e.uploadRef,c=e.validate,l=e.ignoreKeyPress,d=gu()(e,["className","id","placeholder","uploadRef","validate","ignoreKeyPress"]),s=Object(vu.useRef)();s.current=d,Object(vu.useImperativeHandle)(t,(function(){return n.current}),[]);var f=Object(vu.useCallback)((function(){var e=n.current,t=null==e?void 0:e.value;(c?c(t,e):t)&&r.upload(t,s.current)}),[r,c,s,n]),p=Object(vu.useCallback)((function(e){l||"Enter"!==e.key||f()}),[f,l]);return Object(vu.useImperativeHandle)(i,(function(){return f}),[f]),hu.a.createElement("input",{type:"text",id:o,ref:n,className:u,onKeyPress:p,placeholder:a})})),Po=_o,Uo=_o},VPmE:function(e,t,n){"use strict";n.d(t,"e",(function(){return r})),n.d(t,"h",(function(){return d})),n.d(t,"b",(function(){return g})),n.d(t,"i",(function(){return _})),n.d(t,"c",(function(){return w})),n.d(t,"a",(function(){return P})),n.d(t,"j",(function(){return B})),n.d(t,"f",(function(){return D})),n.d(t,"d",(function(){return H.a})),n.d(t,"g",(function(){return p}));var r=function(e){return"function"==typeof e},u=n("/FZm"),o=n.n(u),a=n("FLGM"),i=n.n(a),c=n("o+MX"),l=n.n(c),d=function(e,t,n){var r=!0,u=function(e){var t,n=l()(t=[]).call(t,e);return function(e){return i()(e).call(e,(function(e){return i()(n).call(n,(function(t){return e[t]})).join()}))}}(n);if(e&&t&&e.length===t.length){var a=u(e),c=u(t);r=!!o()(a).call(a,(function(e,t){return e!==c[t]}))}return!r},s=n("9yv6"),f=n.n(s),p=function(){return!0},g=function(e){return p()?e:f()(e)},v=n("RXMP"),h=n.n(v),b=n("OWCx"),m=n.n(b),S=n("+oHS"),E=n.n(S),y=n("6UaR"),O=n.n(y),I=n("zKQ6"),R=n.n(I),L=n("nhkr"),C=n.n(L),D=function(e){var t;return!!e&&"object"===C()(e)&&("Object"===(null===(t=R()(e))||void 0===t?void 0:t.constructor.name)||null===R()(e))},T=function(e){return D(e)||O()(e)},A=function(e,t){var n=E()(e);return t.withSymbols?l()(n).call(n,m()(e)):n},w=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=function(n){for(var r=arguments.length,u=new Array(r>1?r-1:0),o=1;o<r;o++)u[o-1]=arguments[o];return n&&u.length&&h()(u).call(u,(function(r){var u;r&&h()(u=A(r,e)).call(u,(function(u){var o=r[u];e.predicate&&!e.predicate(u,o)||(void 0!==o||e.undefinedOverwrites)&&(T(o)?(void 0!==n[u]&&D(n[u])||(n[u]=O()(o)?[]:{}),t(n[u],o)):n[u]=o)}))})),n};return t},_=w(),P=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:_;return T(e)?t(O()(e)?[]:{},e):e},U=n("ZbhI"),k=n.n(U),N=n("KYsz"),j=n.n(N),B=function(e,t){var n;return e&&j()(n=E()(e)).call(n,(function(n,r){return~k()(t).call(t,r)&&(n[r]=e[r]),n}),{})},H=n("n5N2")},cDcd:function(t,n){t.exports=e},faye:function(e,n){e.exports=t},n5N2:function(e,t,n){"use strict";var r=n("nhkr"),u=n.n(r);t.a=function(){return"object"===("undefined"==typeof window?"undefined":u()(window))&&!!window.document}},ytft:function(e,t,n){"use strict";n.r(t),function(e){n.d(t,"isDebugOn",(function(){return l})),n.d(t,"setDebug",(function(){return d})),n.d(t,"debugLog",(function(){return s}));var r,u=n("ZbhI"),o=n.n(u),a=n("10TY"),i=n("n5N2"),c=n("VPmE"),l=function(){var t;"boolean"!=typeof r&&(r=!Object(c.g)()&&e.env.DEBUG||Object(i.a)()&&("location"in window&&!!~o()(t=window.location.search).call(t,"rpldy_debug=true")||!0===window[a.b]));return r},d=function(e){Object(i.a)()&&(window[a.b]=e),r=!!e||null},s=function(){var e;l()&&(e=console).log.apply(e,arguments)}}.call(this,n("8oxB"))}})}));
//# sourceMappingURL=rpldy-all.umd.min.js.map