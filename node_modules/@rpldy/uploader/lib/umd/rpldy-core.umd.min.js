/*!
 * MIT License
 * 
 * Copyright (c) 2020 Yoav Niran
 * 
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 * 
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 * 
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 * 
 */
!function(t,n){"object"==typeof exports&&"object"==typeof module?module.exports=n():"function"==typeof define&&define.amd?define([],n):"object"==typeof exports?exports.rpldy=n():t.rpldy=n()}(window,(function(){return function(t){function n(n){for(var r,i,u=n[0],c=n[1],l=n[2],s=0,f=[];s<u.length;s++)i=u[s],Object.prototype.hasOwnProperty.call(o,i)&&o[i]&&f.push(o[i][0]),o[i]=0;for(r in c)Object.prototype.hasOwnProperty.call(c,r)&&(t[r]=c[r]);for(d&&d(n);f.length;)f.shift()();return a.push.apply(a,l||[]),e()}function e(){for(var t,n=0;n<a.length;n++){for(var e=a[n],r=!0,u=1;u<e.length;u++){var c=e[u];0!==o[c]&&(r=!1)}r&&(a.splice(n--,1),t=i(i.s=e[0]))}return t}var r={},o={core:0},a=[];function i(n){if(r[n])return r[n].exports;var e=r[n]={i:n,l:!1,exports:{}};return t[n].call(e.exports,e,e.exports,i),e.l=!0,e.exports}i.m=t,i.c=r,i.d=function(t,n,e){i.o(t,n)||Object.defineProperty(t,n,{enumerable:!0,get:e})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,n){if(1&n&&(t=i(t)),8&n)return t;if(4&n&&"object"==typeof t&&t&&t.__esModule)return t;var e=Object.create(null);if(i.r(e),Object.defineProperty(e,"default",{enumerable:!0,value:t}),2&n&&"string"!=typeof t)for(var r in t)i.d(e,r,function(n){return t[n]}.bind(null,r));return e},i.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(n,"a",n),n},i.o=function(t,n){return Object.prototype.hasOwnProperty.call(t,n)},i.p="";var u=window.webpackJsonprpldy=window.webpackJsonprpldy||[],c=u.push.bind(u);u.push=n,u=u.slice();for(var l=0;l<u.length;l++)n(u[l]);var d=c;return a.push([0,"polyfills"]),e()}({0:function(t,n,e){e("Xsbf"),e("mHo/"),e("GjXi"),t.exports=e("SXZu")},"10TY":function(t,n,e){"use strict";e.d(n,"b",(function(){return r})),e.d(n,"a",(function(){return o})),e.d(n,"c",(function(){return a}));var r="__rupy-logger-debug__",o={PENDING:"pending",ADDED:"added",PROCESSING:"processing",UPLOADING:"uploading",CANCELLED:"cancelled",FINISHED:"finished",ABORTED:"aborted"},a={PENDING:"pending",ADDED:"added",UPLOADING:"uploading",CANCELLED:"cancelled",FINISHED:"finished",ERROR:"error",ABORTED:"aborted"}},GjXi:function(t,n,e){"use strict";e.r(n),e.d(n,"send",(function(){return N})),e.d(n,"getXhrSend",(function(){return B})),e.d(n,"XHR_SENDER_TYPE",(function(){return f})),e.d(n,"MissingUrlError",(function(){return T}));var r=e("o+MX"),o=e.n(r),a=e("ZbhI"),i=e.n(a),u=e("UtpJ"),c=e.n(u),l=e("kT1S"),d=e.n(l),s=e("mHo/"),f="rpldy-sender",g=e("06Pm"),p=e.n(g),v=e("X5/F"),h=e.n(v),E=e("K82H"),b=e.n(E),S=e("P0a4"),T=function(t){h()(e,t);var n=b()(e);function e(t){var r;return p()(this,e),(r=n.call(this,"".concat(t," didn't receive upload URL"))).name="MissingUrlError",r}return e}(e.n(S)()(Error)),m=e("zLi2"),A=e.n(m),I=e("i5y0"),_=e.n(I),O=e("RXMP"),R=e.n(O),y=function(t,n){for(var e=arguments.length,r=new Array(e>2?e-2:0),a=2;a<e;a++)r[a-2]=arguments[a];var i,u;t.set?t.set.apply(t,o()(i=[n]).call(i,r)):(t.delete&&t.delete(n),t.append.apply(t,o()(u=[n]).call(u,r)))},L=function(t,n){var e,r=new FormData;n.params&&R()(e=_()(n.params)).call(e,(function(t){var n=A()(t,2),e=n[0],o=n[1];return y(r,e,o)}));return function(t,n,e){var r=1===n.length;R()(n).call(n,(function(n,a){var i,u=r?e.paramName:Object(s.isFunction)(e.formatGroupParamName)?e.formatGroupParamName(a,e.paramName):o()(i="".concat(e.paramName,"[")).call(i,a,"]");n.file?y(t,u,n.file,n.file.name):n.url&&y(t,u,n.url)}))}(r,t,n),r},w=[200,201,202,203,204],C=function(t,n,e,r,o){var a,i=(null==o?void 0:o.getRequestData)?o.getRequestData(t,e):function(t,n){var e;if(n.sendWithFormData)s.logger.debugLog("uploady.sender: sending ".concat(t.length," item(s) as form data")),e=L(t,n);else{if(t.length>1)throw new Error("XHR Sender - Request without form data can only contain 1 item. received ".concat(t.length));var r=t[0];s.logger.debugLog("uploady.sender: sending item ".concat(r.id," as request body")),e=r.file||r.url}return e}(t,e),u=function(){var o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:n,u=arguments.length>1&&void 0!==arguments[1]?arguments[1]:i,l=arguments.length>2?arguments[2]:void 0;l=Object(s.merge)(d()(d()({},Object(s.pick)(e,["method","headers","withCredentials"])),{},{preSend:function(n){n.upload.onprogress=function(n){n.lengthComputable&&r&&r(n,c()(t).call(t))}}}),l);var f=Object(s.request)(o,u,l);return a=f.xhr,f},l=(null==o?void 0:o.preRequestHandler)?o.preRequestHandler(u,t,n,e,r,o):u();return{url:n,count:t.length,pXhr:l,getXhr:function(){return a},aborted:!1}},D=function(t,n,e){var r=t,o=n&&n["content-type"];if(e.forceJsonResponse||o&&~i()(o).call(o,"json"))try{r=JSON.parse(t)}catch(t){}return r},P=function(t,n){return t.pXhr.then((function(t){var e,r;s.logger.debugLog("uploady.sender: received upload response ",t),e=~i()(w).call(w,t.status)?s.FILE_STATES.FINISHED:s.FILE_STATES.ERROR,r=t.status;var o=Object(s.parseResponseHeaders)(t);return{status:r,state:e,response:{data:D(t.response,o,n),headers:o}}})).catch((function(n){var e,r;return t.aborted?(e=s.FILE_STATES.ABORTED,r="aborted"):(s.logger.debugLog("uploady.sender: upload failed: ",n),e=s.FILE_STATES.ERROR,r=n),{error:!0,state:e,response:r,status:0}}))},B=function(t){return function(n,e,r,a){if(!e)throw new T(f);s.logger.debugLog("uploady.sender: sending file: ",{items:n,url:e,options:r});var i=C(n,e,r,a,t);return{request:P(i,r),abort:function(){return function(t){var n,e=!1,r=t.aborted,a=(0,t.getXhr)();!r&&a&&a.readyState&&4!==a.readyState&&(s.logger.debugLog(o()(n="uploady.sender: cancelling request with ".concat(t.count," items to: ")).call(n,t.url)),a.abort(),t.aborted=!0,e=!0);return e}(i)},senderType:f}}},N=B();n.default=N},SXZu:function(t,n,e){"use strict";e.r(n),e.d(n,"UPLOADER_EVENTS",(function(){return X})),e.d(n,"DEFAULT_OPTIONS",(function(){return Ht})),e.d(n,"composeEnhancers",(function(){return Yt})),e.d(n,"createUploader",(function(){return Qt})),e.d(n,"send",(function(){return Ft.send})),e.d(n,"getXhrSend",(function(){return Ft.getXhrSend})),e.d(n,"XHR_SENDER_TYPE",(function(){return Ft.XHR_SENDER_TYPE})),e.d(n,"MissingUrlError",(function(){return Ft.MissingUrlError}));var r,o,a=e("FLGM"),i=e.n(a),u=e("OBge"),c=e.n(u),l=e("o+MX"),d=e.n(l),s=e("STz3"),f=e.n(s),g=e("Xsbf"),p=e("mHo/"),v=e("KYsz"),h=e.n(v),E=e("zLi2"),b=e.n(E),S=e("RXMP"),T=e.n(S),m=e("LYCE"),A=e.n(m),I=e("+oHS"),_=e.n(I),O=e("CtDf"),R=e.n(O),y=R()("__rpldy-sstt-proxy__"),L=R()("__rpldy-sstt-state__"),w=e("6UaR"),C=e.n(w),D=e("OWCx"),P=e.n(D),B=e("ZbhI"),N=e.n(B),F=function(t){var n;return!Object(p.isProduction)()&&!!t&&!!~N()(n=P()(t)).call(n,y)},j=function(t){return C()(t)||Object(p.isPlainObject)(t)&&!function(t){return Object(p.hasWindow)()&&t instanceof File||t.name&&t.size&&t.uri}(t)},H=Object(p.getMerge)({withSymbols:!0,predicate:function(t){return t!==y&&t!==L}}),M=function(t){return!!Object(p.isProduction)()||t[L].isUpdateable},G=function(t,n){Object(p.isProduction)()||(t[L].isUpdateable=n)},U=function(t,n){var e,r;j(t)&&(F(t)||(t[y]=!0,e=new Proxy(t,n)),T()(r=_()(t)).call(r,(function(e){t[e]=U(t[e],n)})));return e||t},x=function(t){return F(t)?Object(p.clone)(t,H):t},X=Object(p.devFreeze)({BATCH_ADD:"BATCH-ADD",BATCH_START:"BATCH-START",BATCH_PROGRESS:"BATCH_PROGRESS",BATCH_FINISH:"BATCH-FINISH",BATCH_ABORT:"BATCH-ABORT",BATCH_CANCEL:"BATCH-CANCEL",ITEM_START:"FILE-START",ITEM_CANCEL:"FILE-CANCEL",ITEM_PROGRESS:"FILE-PROGRESS",ITEM_FINISH:"FILE-FINISH",ITEM_ABORT:"FILE-ABORT",ITEM_ERROR:"FILE-ERROR",ITEM_FINALIZE:"FILE-FINALIZE",REQUEST_PRE_SEND:"REQUEST_PRE_SEND",ALL_ABORT:"ALL_ABORT"}),q=Object(p.devFreeze)({ITEM_PROGRESS:"ITEM_PROGRESS",BATCH_PROGRESS:"BATCH_PROGRESS"}),z=[p.FILE_STATES.FINISHED,p.FILE_STATES.ERROR,p.FILE_STATES.CANCELLED,p.FILE_STATES.ABORTED],k=e("cdeZ"),Z=e.n(k),Q=e("5PDf"),Y=e.n(Q),W=e("M5Mt"),J=e.n(W),K=e("04Ix"),V=e.n(K),$=e("/FZm"),tt=e.n($),nt=e("TEMH"),et=e.n(nt),rt=e("mnMc"),ot=e.n(rt),at=e("kT1S"),it=e.n(at),ut=[p.BATCH_STATES.ADDED,p.BATCH_STATES.PROCESSING,p.BATCH_STATES.UPLOADING],ct=function(t,n){return t.batches[n].batch},lt=function(t,n,e){return t.getState().items[n].batchId===e},dt=function(t,n){var e=t.getState(),r=e.items[n];return e.batches[r.batchId]},st=function(t,n){return dt(t,n).batch},ft=function(t,n){var e=function(t,n){return ct(t.getState(),n)}(t,n);t.updateState((function(t){var n;T()(n=e.items).call(n,(function(n){var e,r=n.id;delete t.items[r];var o,a=N()(e=t.itemQueue).call(e,r);~a&&J()(o=t.itemQueue).call(o,a,1)}))}))},gt=function(t,n){t.updateState((function(t){delete t.batches[n]}))},pt=function(t,n){var e=st(t,n);return t.getState().currentBatch!==e.id},vt=function(t){var n=t.getState(),e=n.currentBatch;e&&n.batches[e]&&function(t){var n=t.getState().itemQueue;return 0===n.length||pt(t,n[0])}(t)&&(ht(t,e,X.BATCH_FINISH),ft(t,e),gt(t,e))},ht=function(t,n,e){var r,o=t.getState(),a=ct(o,n),u=o.items,c=it()(it()({},x(a)),{},{items:i()(r=a.items).call(r,(function(t){var n=t.id;return x(u[n])}))});t.trigger(e,c)},Et=function(t,n){var e=st(t,n);return ot()(ut).call(ut,e.state)},bt=function(t,n){var e,r=t.getState(),o=ct(r,n);tt()(e=o.items).call(e,(function(t){return!ot()(z).call(z,t.state)}))||(ft(t,n),gt(t,n))},St=(r={},V()(r,p.FILE_STATES.PENDING,null),V()(r,p.FILE_STATES.ADDED,X.ITEM_START),V()(r,p.FILE_STATES.FINISHED,X.ITEM_FINISH),V()(r,p.FILE_STATES.ERROR,X.ITEM_ERROR),V()(r,p.FILE_STATES.CANCELLED,X.ITEM_CANCEL),V()(r,p.FILE_STATES.ABORTED,X.ITEM_ABORT),V()(r,p.FILE_STATES.UPLOADING,X.ITEM_PROGRESS),r),Tt=function(t){return!!~N()(z).call(z,t.state)},mt=function(t,n,e){return T()(n).call(n,(function(n){var e,r=t.getState(),o=n.id,a=n.info;if(p.logger.debugLog("uploader.processor.queue: request finished for item - ",{id:o,info:a}),r.items[o]){t.updateState((function(t){var n=t.items[o];n.state=a.state,n.uploadResponse=a.response,Tt(n)&&delete t.aborts[o]}));var i=t.getState().items[o];a.state===p.FILE_STATES.FINISHED&&i.completed<100&&t.handleItemProgress(i,100,i.file?i.file.size:0),St[i.state]&&t.trigger(St[i.state],i),Tt(i)&&t.trigger(X.ITEM_FINALIZE,i)}var u=N()(e=r.itemQueue).call(e,o);~u&&t.updateState((function(t){var n,e;J()(n=t.itemQueue).call(n,u,1);var r,a=N()(e=t.activeIds).call(e,o);~a&&J()(r=t.activeIds).call(r,a,1)}))})),vt(t),e(t)},At=Object(p.getMerge)({undefinedOverwrites:!0}),It=function(t,n){var e=i()(n).call(n,(function(t){return t.id}));return t.updateState((function(t){var n;t.activeIds=d()(n=t.activeIds).call(n,e)})),function(t,n,e){return Object(p.triggerUpdater)(t.trigger,X.REQUEST_PRE_SEND,{items:n,options:e}).then((function(t){if(t){if(p.logger.debugLog("uploader.queue: REQUEST_PRE_SEND event returned updated items/options",t),t.items){if(t.items.length!==n.length||!Object(p.isSamePropInArrays)(t.items,n,["id","batchId","recycled"]))throw new Error("REQUEST_PRE_SEND event handlers must return same items with same ids");n=t.items}t.options&&(e=At({},e,t.options))}return{items:n,options:e,cancelled:!1===t}}))}(t,n,t.getState().batches[n[0].batchId].batchOptions).then((function(e){if(!e.cancelled){var r;t.updateState((function(t){var r;T()(r=e.items).call(r,(function(n){t.items[n.id]=n})),t.batches[n[0].batchId].batchOptions=e.options}));var o=t.getState();e.items=i()(r=e.items).call(r,(function(t){return o.items[t.id]})),e.options=o.batches[n[0].batchId].batchOptions}return e}))},_t=function(t,n,e){var r,o=n.items,a=n.options,u=t.getState().batches[o[0].batchId].batch;try{r=t.sender.send(o,u,a)}catch(t){p.logger.debugLog("uploader.queue: sender failed with unexpected error",t),r={request:c.a.resolve({status:0,state:p.FILE_STATES.ERROR,response:t.message}),abort:function(){return!1},senderType:"exception-handler"}}return function(t,n,e){t.updateState((function(t){T()(n).call(n,(function(n){t.items[n.id].state=p.FILE_STATES.UPLOADING,t.aborts[n.id]=e.abort}))}))}(t,o,r),r.request.then((function(n){var r=i()(o).call(o,(function(t){return{id:t.id,info:n}}));mt(t,r,e)}))},Ot=function(t,n,e){var r=t.getState(),o=f()(r.items);return o=Y()(o).call(o,(function(t){return!!~N()(n).call(n,t.id)})),c.a.all(i()(o).call(o,(function(n){return t.runCancellable(X.ITEM_START,n)}))).then((function(n){var e;return{allowedItems:Y()(e=i()(n).call(n,(function(n,e){return n?null:function(t,n){return n.getState().items[t]}(o[e].id,t)}))).call(e,Boolean),cancelledResults:n}})).then((function(r){var a=r.allowedItems,u=r.cancelledResults;return(a.length?It(t,a).then():c.a.resolve()).then((function(r){var a;return r&&(r.cancelled?u=i()(n).call(n,(function(){return!0})):_t(t,r,e)),function(t,n,e,r){var o,a=Y()(o=i()(e).call(e,(function(t,e){return t?n[e].id:null}))).call(o,Boolean);if(a.length){var u=i()(a).call(a,(function(t){return{id:t,info:{status:0,state:p.FILE_STATES.CANCELLED,response:"cancel"}}}));mt(t,u,r)}return!!a.length}(t,o,u,e)||(a=e(t)),a}))}))},Rt=function(t,n){var e,r;return!!~N()(e=Z()(r=t.getState().activeIds).call(r)).call(e,n)},yt=function(t){var n,e=t.getState().itemQueue,r=function(t){for(var n=t.getState(),e=n.itemQueue,r=n.items,o=0,a=e[o];a&&(Rt(t,a)||!Et(t,a)||r[a].state!==p.FILE_STATES.ADDED);)a=e[o+=1];return a?o:-1}(t),o=e[r];if(o){var a=dt(t,o),i=a.batch.id,u=a.batchOptions.maxGroupSize||0;if(a.batchOptions.grouped&&u>1){n=[];for(var c=!0;n.length<u&&c;)n.push(o),c=(o=e[r+n.length])&&lt(t,o,i)}else n=[o]}return n},Lt=function(t){var n=yt(t),e=c.a.resolve();if(n){var r=t.getCurrentActiveCount(),o=t.getOptions(),a=o.concurrent,i=void 0===a?0:a,u=o.maxConcurrent;if(!r||i&&r<(void 0===u?0:u)){p.logger.debugLog("uploader.processor: Processing next upload - ",{ids:n,state:t.getState(),currentCount:r});var l=!1,d=c.a.resolve(!1);pt(t,n[0])&&(d=function(t,n){var e=st(t,n);return t.runCancellable(X.BATCH_START,e).then((function(n){return n||t.updateState((function(t){t.currentBatch=e.id})),!n}))}(t,n[0]).then((function(e){return(l=!e)&&(!function(t,n){var e=st(t,n),r=e.id;p.logger.debugLog("uploady.uploader.processor: cancelling batch: ",{batch:e}),t.updateState((function(t){ct(t,r).state=p.BATCH_STATES.CANCELLED})),ht(t,r,X.BATCH_CANCEL),ft(t,r),gt(t,r)}(t,n[0]),Lt(t)),l}))),e=d.then((function(e){e||Ot(t,n,Lt)}))}}return e},wt=Lt,Ct=function(t,n,e,r){return p.logger.debugLog("uploader.queue: aborting ".concat(n.state," item  - "),n),mt(t,[{id:n.id,info:{status:0,state:p.FILE_STATES.ABORTED,response:"aborted"}}],e),r||bt(t,n.batchId),!0},Dt=(o={},V()(o,p.FILE_STATES.UPLOADING,(function(t,n){return p.logger.debugLog("uploader.queue: aborting uploading item  - ",n),t.getState().aborts[n.id]()})),V()(o,p.FILE_STATES.ADDED,Ct),V()(o,p.FILE_STATES.PENDING,Ct),o),Pt=function(t,n,e){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o=t.getState(),a=o.items[n],i=null==a?void 0:a.state;return!!Dt[i]&&Dt[i](t,a,e,r)},Bt=function(t,n,e){var r,o=t.getState().batches[n],a=null==o?void 0:o.batch;a&&function(t){return t.state!==p.BATCH_STATES.CANCELLED&&t.state!==p.BATCH_STATES.FINISHED}(a)&&(T()(r=a.items).call(r,(function(n){return Pt(t,n.id,e,!0)})),t.updateState((function(t){ct(t,n).state=p.BATCH_STATES.ABORTED})),ht(t,n,X.BATCH_ABORT),bt(t,a.id))},Nt=function(t,n,e,r,o){var a=function(t){var n={set:function(t,r,o){return M(e)&&(t[r]=U(o,n)),!0},get:function(t,n){return n===y?x(t):t[n]},defineProperty:function(){throw new Error("Simple State doesnt support defining property")},setPrototypeOf:function(){throw new Error("Simple State doesnt support setting prototype")},deleteProperty:function(t,n){return M(e)&&delete t[n],!0}};Object(p.isProduction)()||F(t)||A()(t,L,{value:{isUpdateable:!1},configurable:!0});var e=Object(p.isProduction)()?t:U(t,n);return{state:e,update:function(t){if(!Object(p.isProduction)()&&M(e))throw new Error("Can't call update on State already being updated!");try{G(e,!0),t(e)}finally{G(e,!1)}return e},unwrap:function(t){return t?x(t):F(e)?x(e):e}}}({itemQueue:[],currentBatch:null,batches:{},items:{},activeIds:[],aborts:{}}),i=a.state,u=a.update,c=function(){return i},l=function(t){u(t)},s=function(t){if(i.items[t.id]&&!t.recycled)throw new Error("Uploader queue conflict - item ".concat(t.id," already exists"));t.recycled&&function(t,n){var e=n.previousBatch;if(n.recycled&&e&&t.getState().batches[e]){var r=st(t,n.id).id;r===e&&t.updateState((function(t){var e,o,a=ct(t,r),i=et()(e=a.items).call(e,(function(t){return t.id===n.id}));~i&&J()(o=a.items).call(o,i,1)}))}}(g,t),l((function(n){n.items[t.id]=t,n.itemQueue.push(t.id)}))},f=function(t,e,r){i.items[t.id]&&(l((function(n){var o=n.items[t.id];o.loaded=r,o.completed=e})),n(X.ITEM_PROGRESS,c().items[t.id]))};r.on(q.ITEM_PROGRESS,f),r.on(q.BATCH_PROGRESS,(function(t){var e,r=null===(e=i.batches[t.id])||void 0===e?void 0:e.batch.items;if(r){var o=h()(r).call(r,(function(t,n){return t[0]+=n.completed,t[1]+=n.loaded,t}),[0,0]),a=b()(o,2),u=a[0],c=a[1];l((function(n){var e=n.batches[t.id].batch;e.completed=u/r.length,e.loaded=c})),n(X.BATCH_PROGRESS,i.batches[t.id].batch)}}));var g={getOptions:function(){return t},getCurrentActiveCount:function(){return i.activeIds.length},getState:c,updateState:l,trigger:n,runCancellable:function(t){var n;if(!Object(p.isFunction)(e))throw new Error("cancellable is of wrong type");for(var r=arguments.length,o=new Array(r>1?r-1:0),a=1;a<r;a++)o[a-1]=arguments[a];return e.apply(void 0,d()(n=[t]).call(n,o))},sender:r,handleItemProgress:f};return Object(p.hasWindow)()&&p.logger.isDebugOn()&&(window["__rpldy_".concat(o,"_queue_state")]=g),{updateState:l,getState:g.getState,runCancellable:g.runCancellable,uploadBatch:function(t,n){n&&l((function(e){e.batches[t.id].batchOptions=n})),wt(g)},addBatch:function(t,n){var e;return l((function(e){e.batches[t.id]={batch:t,batchOptions:n}})),T()(e=t.items).call(e,s),ct(i,t.id)},abortItem:function(t){return function(t,n,e){return Pt(t,n,e)}(g,t,wt)},abortBatch:function(t){Bt(g,t,wt)},abortAll:function(){var t,n,e,r;n=wt,r=(t=g).getState().items,T()(e=_()(r)).call(e,(function(e){return Pt(t,e,n)})),t.trigger(X.ALL_ABORT)},clearPendingBatches:function(){var t,n,e,r;r=(t=g).getState().batches,T()(n=Y()(e=_()(r)).call(e,(function(t){return r[t].batch.state===p.BATCH_STATES.PENDING}))).call(n,(function(n){ft(t,n),gt(t,n)}))},uploadPendingBatches:function(t){!function(t,n){t.updateState((function(t){var e;T()(e=_()(t.batches)).call(e,(function(e){var r,o=t.batches[e],a=o.batch,i=o.batchOptions;a.state===p.BATCH_STATES.PENDING&&(T()(r=a.items).call(r,(function(t){t.state=p.FILE_STATES.ADDED})),a.state=p.BATCH_STATES.ADDED,o.batchOptions=Object(p.merge)({},i,n))}))}))}(g,t),wt(g)}}},Ft=e("GjXi"),jt=function(){return!0},Ht=Object(p.devFreeze)({autoUpload:!0,clearPendingOnAdd:!1,inputFieldName:"file",concurrent:!1,maxConcurrent:2,grouped:!1,maxGroupSize:5,method:"POST",params:{},fileFilter:jt,forceJsonResponse:!1,withCredentials:!1,destination:{},send:null,sendWithFormData:!0}),Mt=function(t,n,e,r){!function(t,n,e,r){T()(t).call(t,(function(t){var o,a;p.logger.debugLog(d()(o=d()(a="uploady.uploader.processor: file: ".concat(t.id," progress event: loaded(")).call(a,e,") - completed(")).call(o,n,")")),r(q.ITEM_PROGRESS,t,n,e)}))}(t,Math.min(e.loaded/e.total*100,100)/t.length,e.loaded/t.length,r),r(q.BATCH_PROGRESS,n)},Gt=function(){var t=Object(g.default)({send:function(t,e,r){var o=r.destination,a=null==o?void 0:o.url,i=Object(p.throttle)((function(r){return Mt(t,e,r,n)}),50,!0);return(Object(p.isFunction)(r.send)?r.send:Ft.default)(t,a,{method:(null==o?void 0:o.method)||r.method||Ht.method,paramName:(null==o?void 0:o.filesParamName)||r.inputFieldName||"file",params:it()(it()({},r.params),null==o?void 0:o.params),forceJsonResponse:r.forceJsonResponse,withCredentials:r.withCredentials,formatGroupParamName:r.formatGroupParamName,headers:null==o?void 0:o.headers,sendWithFormData:r.sendWithFormData},i)}},f()(q)),n=t.trigger;return t.target},Ut=Object(p.hasWindow)()&&"FileList"in window,xt=function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,e=t;if(!Object(p.isProduction)())if(n<3&&F(t))e=x(t);else if(n<3&&j(t)){var r,o;e=C()(t)?i()(r=_()(t)).call(r,(function(n){return xt(t[n])})):h()(o=_()(t)).call(o,(function(e,r){return e[r]=xt(t[r],n+1),e}),{})}return e},Xt=0,qt=function(t,n,e,r){var o;return i()(o=Y()(Array.prototype).call(n,r||jt)).call(o,(function(n){return Object(p.createBatchItem)(n,t,e)}))},zt=function(t,n,e){var r="batch-".concat(Xt+=1),o=function(t){return Ut&&t instanceof FileList||"[object FileList]"===t.toString()}(t);t=C()(t)||o?t:[t];var a=!e.autoUpload;return{id:r,uploaderId:n,items:qt(r,t,a,e.fileFilter),state:a?p.BATCH_STATES.PENDING:p.BATCH_STATES.ADDED,completed:0,loaded:0}},kt=f()(X),Zt=0,Qt=function(t){var n="uploader-".concat(Zt+=1),e=!1,r={};p.logger.debugLog("uploady.uploader: creating new instance (".concat(n,")"),{options:t,counter:Zt});var o=function(t){return it()(it()(it()({},Ht),t),{},{destination:t&&t.destination?(n=t.destination,it()({params:{}},n)):null});var n}(t),a=function(){E.clearPendingBatches()},u=Object(g.default)({id:n,update:function(t){return o=Object(p.merge)({},o,t),s},add:function(t,n){var e=Object(p.merge)({},o,n);e.clearPendingOnAdd&&a();var r,i=E.addNewBatch(t,s.id,e);return i.items.length?r=E.runCancellable(X.BATCH_ADD,i,e).then((function(t){var n;t?(i.state=p.BATCH_STATES.CANCELLED,f(X.BATCH_CANCEL,i)):(p.logger.debugLog(d()(n="uploady.uploader [".concat(s.id,"]: new items added - auto upload =\n                        ")).call(n,String(e.autoUpload)),i.items),e.autoUpload&&E.process(i))})):p.logger.debugLog("uploady.uploader: no items to add. batch ".concat(i.id," is empty. check fileFilter if this isn't intended")),r||c.a.resolve()},upload:function(t){E.processPendingBatches(t)},abort:function(t){E.abort(t)},abortBatch:function(t){E.abortBatch(t)},getOptions:function(){return Object(p.clone)(o)},clearPending:a,registerExtension:function(t,n){Object(p.invariant)(e,"Uploady - uploader extensions can only be registered by enhancers"),Object(p.invariant)(!r[t],"Uploady - uploader extension by this name [%s] already exists",t),p.logger.debugLog("uploady.uploader: registering extension: ".concat(t.toString()),n),r[t]=n},getExtension:function(t){return r[t]}},kt,{canAddEvents:!1,canRemoveEvents:!1}),l=u.trigger,s=u.target,f=function(t){for(var n=arguments.length,e=new Array(n>1?n-1:0),r=1;r<n;r++)e[r-1]=arguments[r];var o=Object(g.createLifePack)((function(){return i()(e).call(e,xt)}));return l(t,o)},v=Object(p.triggerCancellable)(f);if(o.enhancer){e=!0;var h=o.enhancer(s,f);e=!1,s=h||s}var E=function(t,n,e,r){var o=Gt(),a=Nt(e,t,n,o,r);return{process:function(t,n){a.uploadBatch(t,n)},abortBatch:function(t){a.abortBatch(t)},abort:function(t){t?a.abortItem(t):a.abortAll()},addNewBatch:function(t,n,e){var r=zt(t,n,e);return a.addBatch(r,e)},runCancellable:a.runCancellable,clearPendingBatches:function(){a.clearPendingBatches()},processPendingBatches:function(t){a.uploadPendingBatches(t)}}}(f,v,o,s.id);return Object(p.devFreeze)(s)},Yt=function(){for(var t=arguments.length,n=new Array(t),e=0;e<t;e++)n[e]=arguments[e];return function(t){for(var e=arguments.length,r=new Array(e>1?e-1:0),o=1;o<e;o++)r[o-1]=arguments[o];return h()(n).call(n,(function(t,n){var e;return n.apply(void 0,d()(e=[t]).call(e,r))||t}),t)}};n.default=Qt},VPmE:function(t,n,e){"use strict";e.d(n,"e",(function(){return r})),e.d(n,"h",(function(){return d})),e.d(n,"b",(function(){return p})),e.d(n,"i",(function(){return D})),e.d(n,"c",(function(){return C})),e.d(n,"a",(function(){return P})),e.d(n,"j",(function(){return H})),e.d(n,"f",(function(){return y})),e.d(n,"d",(function(){return M.a})),e.d(n,"g",(function(){return g}));var r=function(t){return"function"==typeof t},o=e("/FZm"),a=e.n(o),i=e("FLGM"),u=e.n(i),c=e("o+MX"),l=e.n(c),d=function(t,n,e){var r=!0,o=function(t){var n,e=l()(n=[]).call(n,t);return function(t){return u()(t).call(t,(function(t){return u()(e).call(e,(function(n){return t[n]})).join()}))}}(e);if(t&&n&&t.length===n.length){var i=o(t),c=o(n);r=!!a()(i).call(i,(function(t,n){return t!==c[n]}))}return!r},s=e("9yv6"),f=e.n(s),g=function(){return!0},p=function(t){return g()?t:f()(t)},v=e("RXMP"),h=e.n(v),E=e("OWCx"),b=e.n(E),S=e("+oHS"),T=e.n(S),m=e("6UaR"),A=e.n(m),I=e("zKQ6"),_=e.n(I),O=e("nhkr"),R=e.n(O),y=function(t){var n;return!!t&&"object"===R()(t)&&("Object"===(null===(n=_()(t))||void 0===n?void 0:n.constructor.name)||null===_()(t))},L=function(t){return y(t)||A()(t)},w=function(t,n){var e=T()(t);return n.withSymbols?l()(e).call(e,b()(t)):e},C=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=function(e){for(var r=arguments.length,o=new Array(r>1?r-1:0),a=1;a<r;a++)o[a-1]=arguments[a];return e&&o.length&&h()(o).call(o,(function(r){var o;r&&h()(o=w(r,t)).call(o,(function(o){var a=r[o];t.predicate&&!t.predicate(o,a)||(void 0!==a||t.undefinedOverwrites)&&(L(a)?(void 0!==e[o]&&y(e[o])||(e[o]=A()(a)?[]:{}),n(e[o],a)):e[o]=a)}))})),e};return n},D=C(),P=function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:D;return L(t)?n(A()(t)?[]:{},t):t},B=e("ZbhI"),N=e.n(B),F=e("KYsz"),j=e.n(F),H=function(t,n){var e;return t&&j()(e=T()(t)).call(e,(function(e,r){return~N()(n).call(n,r)&&(e[r]=t[r]),e}),{})},M=e("n5N2")},Xsbf:function(t,n,e){"use strict";e.r(n),e.d(n,"default",(function(){return dt})),e.d(n,"addLife",(function(){return dt})),e.d(n,"isLE",(function(){return $})),e.d(n,"createLifePack",(function(){return vt}));var r=e("04Ix"),o=e.n(r),a=e("RSWj"),i=e.n(a),u=e("HnXd"),c=e.n(u),l=e("M5Mt"),d=e.n(l),s=e("OBge"),f=e.n(s),g=e("Vi3r"),p=e.n(g),v=e("FLGM"),h=e.n(v),E=e("5PDf"),b=e.n(E),S=e("kT1S"),T=e.n(S),m=e("eLKs"),A=e.n(m),I=e("+oHS"),_=e.n(I),O=e("zLi2"),R=e.n(O),y=e("i5y0"),L=e.n(y),w=e("KYsz"),C=e.n(w),D=e("STz3"),P=e.n(D),B=e("cdeZ"),N=e.n(B),F=e("UtpJ"),j=e.n(F),H=e("/FZm"),M=e.n(H),G=e("ZbhI"),U=e.n(G),x=e("JlUD"),X=e.n(x),q=e("mHo/"),z=Object(q.devFreeze)({allowRegisterNonExistent:!0,canAddEvents:!0,canRemoveEvents:!0,collectStats:!1}),k=function(t,n){if(!Object(q.isFunction)(t))throw new Error("'".concat(n,"' is not a valid function"))},Z=function(t){return void 0===t},Q=e("CtDf"),Y=e.n(Q),W=Y()("__le__"),J=Y()("__le__pack__"),K=function(t){return t?t[W]:null},V=function(t){var n=K(t);if(!n)throw new Error("Didnt find LE internal object. Something very bad happened!");return n},$=function(t){return!!K(t)},tt=function(t,n,e){var r,o=arguments.length>3&&void 0!==arguments[3]&&arguments[3];k(e,"cb");var a=V(t);if(!a.options.allowRegisterNonExistent&&!~U()(r=a.events).call(r,n))throw new Error("Cannot register for event ".concat(n.toString()," that wasn't already defined (allowRegisterNonExistent = false)"));var i=a.registry[n]||[];return M()(i).call(i,(function(t){return t.cb===e}))||(i.push({name:n,cb:e,once:o}),a.registry[n]=i),function(){return ct.call(t,n,e)}},nt=function(t,n){var e,r,o=V(t).registry;return n?o[n]?j()(e=o[n]).call(e):[]:N()(r=P()(o)).call(r)},et={on:function(t,n){return tt(this,t,n)},once:function(t,n){return tt(this,t,n,!0)},off:ct,getEvents:function(){var t;return j()(t=V(this).events).call(t)}},rt=function(){var t;return C()(t=L()(et)).call(t,(function(t,n){var e=R()(n,2),r=e[0],o=e[1];return t[r]={value:o},t}),{})},ot={trigger:function(t){for(var n=this,e=arguments.length,r=new Array(e>1?e-1:0),o=1;o<e;o++)r[o-1]=arguments[o];var a,i=nt(this,t);if(i.length){var u,c,l,d;1===r.length&&!0===(null===(u=r[0])||void 0===u?void 0:u[J])&&(d=r[0].resolve()),a=h()(c=b()(l=h()(i).call(i,(function(e){return e.once&&ut(n,t,e.cb),d?e.cb.apply(e,p()(d)):r.length?1===r.length?e.cb(r[0]):2===r.length?e.cb(r[0],r[1]):3===r.length?e.cb(r[0],r[1],r[2]):e.cb.apply(e,r):e.cb()}))).call(l,(function(t){return!Z(t)}))).call(c,(function(t){return X()(t)?t:f.a.resolve(t)}))}return a&&(a.length?a:void 0)},addEvent:function(t){var n=V(this);if(!n.options.canAddEvents)throw new Error("Cannot add new events (canAddEvents = false)");var e;if(~U()(e=n.events).call(e,t))throw new Error("Event '".concat(t,"' already defined"));n.events.push(t)},removeEvent:function(t){var n=V(this);if(!n.options.canRemoveEvents)throw new Error("Cannot remove events (canRemoveEvents = false)");var e,r,o=U()(e=n.events).call(e,t);d()(r=n.events).call(r,o,1)},hasEvent:function(t){var n,e=V(this);return!!~U()(n=e.events).call(n,t)},hasEventRegistrations:function(t){return!!nt(this,t).length},assign:function(t){var n=V(this);return lt(t,n.options,n.events,n.registry,n.stats),at(t)}},at=function(t){var n;return C()(n=_()(ot)).call(n,(function(n,e){var r;return n[e]=A()(r=ot[e]).call(r,t),n}),T()({target:t},ot))},it=function(t,n){var e=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=V(t).registry;!r[n]||!e&&r[n].length||delete r[n]},ut=function(t,n,e){var r,o=V(t).registry;o[n]&&(e?(o[n]=b()(r=o[n]).call(r,(function(t){return t.cb!==e})),it(t,n)):it(t,n,!0))};function ct(t,n){ut(this,t,n)}var lt=function(t,n){var e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};c()(t,T()(o()({},W,{value:i()({registry:r,events:e,options:n,stats:a})}),rt()))},dt=function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],e=arguments.length>2?arguments[2]:void 0;return t=t||{},e=T()(T()({},z),e),$(t)||lt(t,e,n),at(t)},st=e("LYCE"),ft=e.n(st),gt=e("o+MX"),pt=e.n(gt),vt=function(t){var n={resolve:function(){var n;return pt()(n=[]).call(n,t())}};return ft()(n,J,{value:!0,configurable:!1}),n}},"mHo/":function(t,n,e){"use strict";e.r(n),e.d(n,"BATCH_STATES",(function(){return u.a})),e.d(n,"FILE_STATES",(function(){return u.c})),e.d(n,"invariant",(function(){return o.a})),e.d(n,"throttle",(function(){return i.a})),e.d(n,"logger",(function(){return c})),e.d(n,"triggerCancellable",(function(){return v})),e.d(n,"triggerUpdater",(function(){return E})),e.d(n,"createBatchItem",(function(){return L})),e.d(n,"request",(function(){return X})),e.d(n,"parseResponseHeaders",(function(){return x})),e.d(n,"isFunction",(function(){return q.e})),e.d(n,"isPlainObject",(function(){return q.f})),e.d(n,"isSamePropInArrays",(function(){return q.h})),e.d(n,"devFreeze",(function(){return q.b})),e.d(n,"merge",(function(){return q.i})),e.d(n,"getMerge",(function(){return q.c})),e.d(n,"clone",(function(){return q.a})),e.d(n,"pick",(function(){return q.j})),e.d(n,"hasWindow",(function(){return q.d})),e.d(n,"isProduction",(function(){return q.g}));var r=e("kvau"),o=e.n(r),a=e("uDTZ"),i=e.n(a),u=e("10TY"),c=e("ytft"),l=e("TEMH"),d=e.n(l),s=e("o+MX"),f=e.n(s),g=e("OBge"),p=e.n(g),v=function(t,n){for(var e,r=function(n){for(var e=arguments.length,r=new Array(e>1?e-1:0),o=1;o<e;o++)r[o-1]=arguments[o];return new p.a((function(e,o){var a,i=t.apply(void 0,f()(a=[n]).call(a,r));i&&i.length?p.a.all(i).catch(o).then((function(t){return t&&e(!!~d()(t).call(t,(function(t){return!1===t})))})):e(!1)}))},o=arguments.length,a=new Array(o>2?o-2:0),i=2;i<o;i++)a[i-2]=arguments[i];return n?r.apply(void 0,f()(e=[n]).call(e,a)):r},h=function(t){return null==t},E=function(t,n){for(var e,r=function(n){for(var e=arguments.length,r=new Array(e>1?e-1:0),o=1;o<e;o++)r[o-1]=arguments[o];return new p.a((function(e,o){var a,i=t.apply(void 0,f()(a=[n]).call(a,r));i&&i.length?p.a.all(i).catch(o).then((function(t){var n;if(t)for(;h(n)&&t.length;)n=t.pop();e(h(n)?void 0:n)})):e()}))},o=arguments.length,a=new Array(o>2?o-2:0),i=2;i<o;i++)a[i-2]=arguments[i];return n?r.apply(void 0,f()(e=[n]).call(e,a)):r},b=e("LYCE"),S=e.n(b),T=e("nhkr"),m=e.n(T),A=e("CtDf"),I=e.n(A)()("__rpldy-bi__"),_=0,O=function(t,n){return t.url=n,t},R=function(t,n){return t.file=n,t},y=function(t){return t&&(t instanceof Blob||t instanceof File||"object"===m()(t)&&t.name&&t.type)},L=function(t,n){var e,r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];_+=1;var o=t.id&&t.batchId?t.id:f()(e="".concat(n,".item-")).call(e,_),a=r?u.c.PENDING:u.c.ADDED,i={id:o,batchId:n,state:a,completed:0,loaded:0,aborted:!1,recycled:!1,previousBatch:null};if(S()(i,I,{value:!0,writable:!0}),"object"===m()(t)&&!0===t[I]&&(i.recycled=!0,i.previousBatch=t.batchId,t=t.file||t.url),"string"==typeof t)i=O(i,t);else{if(!y(t))throw new Error("Unknown type of file added: ".concat(m()(t)));i=R(i,t)}return i},w=e("+oHS"),C=e.n(w),D=e("RXMP"),P=e.n(D),B=function(t,n){var e;n&&P()(e=C()(n)).call(e,(function(e){void 0!==n[e]&&t.setRequestHeader(e,n[e])}))},N=function(t,n){var e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=new XMLHttpRequest,o=new p.a((function(o,a){r.onerror=function(){return a(r)},r.ontimeout=function(){return a(r)},r.onabort=function(){return a(r)},r.onload=function(){return o(r)},r.open(e.method||"GET",t),B(r,e.headers),r.withCredentials=!!e.withCredentials,e.preSend&&e.preSend(r),r.send(n)}));return o.xhr=r,o},F=e("zLi2"),j=e.n(F),H=e("RKTd"),M=e.n(H),G=e("KYsz"),U=e.n(G),x=function(t){var n;try{var e,r;n=U()(e=M()(r=t.getAllResponseHeaders()).call(r).split(/[\r\n]+/)).call(e,(function(t,n){var e=n.split(": "),r=j()(e,2),o=r[0],a=r[1];return t[o]=a,t}),{})}catch(n){Object(c.debugLog)("uploady.request: failed to read response headers",t)}return n},X=N,q=e("VPmE")},n5N2:function(t,n,e){"use strict";var r=e("nhkr"),o=e.n(r);n.a=function(){return"object"===("undefined"==typeof window?"undefined":o()(window))&&!!window.document}},ytft:function(t,n,e){"use strict";e.r(n),function(t){e.d(n,"isDebugOn",(function(){return l})),e.d(n,"setDebug",(function(){return d})),e.d(n,"debugLog",(function(){return s}));var r,o=e("ZbhI"),a=e.n(o),i=e("10TY"),u=e("n5N2"),c=e("VPmE"),l=function(){var n;"boolean"!=typeof r&&(r=!Object(c.g)()&&t.env.DEBUG||Object(u.a)()&&("location"in window&&!!~a()(n=window.location.search).call(n,"rpldy_debug=true")||!0===window[i.b]));return r},d=function(t){Object(u.a)()&&(window[i.b]=t),r=!!t||null},s=function(){var t;l()&&(t=console).log.apply(t,arguments)}}.call(this,e("8oxB"))}})}));
//# sourceMappingURL=rpldy-core.umd.min.js.map